!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.vl=a()}}(function(){return function d(a,b,c){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,d,a,b,c)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<c.length;g++)e(c[g]);return e}({1:[function(a,b,c){},{}],2:[function(a,b,c){(function(a){function g(a,b){var d,c="";for(d=0;a>d;++d)c+=b;return c}function h(a,b,c){var d=0,e=a.split(i);return a=c?(e=e.reverse()).filter(function(a){return d+=a.length,b>=d}).reverse():e.filter(function(a){return d+=a.length,b>=d}),a.length?a.join("").trim():e[0].slice(0,b)}var c=b.exports,d="__name__";c.namedfunc=function(a,b){return b[d]=a,b},c.name=function(a){return null==a?null:a[d]},c.identity=function(a){return a},c["true"]=c.namedfunc("true",function(){return!0}),c["false"]=c.namedfunc("false",function(){return!1}),c.duplicate=function(a){return JSON.parse(JSON.stringify(a))},c.equal=function(a,b){return JSON.stringify(a)===JSON.stringify(b)},c.extend=function(a){for(var b,c,d=1,e=arguments.length;e>d;++d){b=arguments[d];for(c in b)a[c]=b[c]}return a},c.length=function(a){return null!=a&&null!=a.length?a.length:null},c.keys=function(a){var c,b=[];for(c in a)b.push(c);return b},c.vals=function(a){var c,b=[];for(c in a)b.push(a[c]);return b},c.toMap=function(a,b){return(b=c.$(b))?a.reduce(function(a,c){return a[b(c)]=1,a},{}):a.reduce(function(a,b){return a[b]=1,a},{})},c.keystr=function(a){var b=a.length;if(!b)return"";for(var c=String(a[0]),d=1;b>d;++d)c+="|"+String(a[d]);return c};var e=Object.prototype.toString;c.isObject=function(a){return a===Object(a)},c.isFunction=function(a){return"[object Function]"===e.call(a)},c.isString=function(a){return"string"==typeof value||"[object String]"===e.call(a)},c.isArray=Array.isArray||function(a){return"[object Array]"===e.call(a)},c.isNumber=function(a){return"number"==typeof a||"[object Number]"===e.call(a)},c.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==e.call(a)},c.isDate=function(a){return"[object Date]"===e.call(a)},c.isValid=function(a){return null!=a&&a===a},c.isBuffer="function"==typeof a&&a.isBuffer||c["false"],c.number=function(a){return null==a||""===a?null:+a},c["boolean"]=function(a){return null==a||""===a?null:"false"===a?!1:!!a},c.date=function(a,b){var c=b?b:Date;return null==a||""===a?null:c.parse(a)},c.array=function(a){return null!=a?c.isArray(a)?a:[a]:[]},c.str=function(a){return c.isArray(a)?"["+a.map(c.str)+"]":c.isObject(a)||c.isString(a)?JSON.stringify(a).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):a};var f=/\[(.*?)\]|[^.\[]+/g;c.field=function(a){return String(a).match(f).map(function(a){return"["!==a[0]?a:"'"!==a[1]&&'"'!==a[1]?a.slice(1,-1):a.slice(2,-2).replace(/\\(["'])/g,"$1")})},c.accessor=function(a){return null==a||c.isFunction(a)?a:c.namedfunc(a,Function("x","return x["+c.field(a).map(c.str).join("][")+"];"))},c.$=c.accessor,c.mutator=function(a){var b;return c.isString(a)&&(b=c.field(a)).length>1?function(a,c){for(var d=0;d<b.length-1;++d)a=a[b[d]];a[b[d]]=c}:function(b,c){b[a]=c}},c.$func=function(a,b){return function(d){d=c.$(d)||c.identity;var e=a+(c.name(d)?"_"+c.name(d):"");return c.namedfunc(e,function(a){return b(d(a))})}},c.$valid=c.$func("valid",c.isValid),c.$length=c.$func("length",c.length),c.$in=function(a,b){a=c.$(a);var d=c.isArray(b)?c.toMap(b):b;return function(b){return!!d[a(b)]}},c.comparator=function(a){var b=[];return void 0===a&&(a=[]),a=c.array(a).map(function(a){var d=1;return"-"===a[0]?(d=-1,a=a.slice(1)):"+"===a[0]&&(d=1,a=a.slice(1)),b.push(d),c.accessor(a)}),function(d,e){var f,g,h,i;for(f=0,g=a.length;g>f;++f)if(h=a[f],i=c.cmp(h(d),h(e)))return i*b[f];return 0}},c.cmp=function(a,b){return(b>a||null==a)&&null!=b?-1:(a>b||null==b)&&null!=a?1:(b=b instanceof Date?+b:b,(a=a instanceof Date?+a:a)!==a&&b===b?-1:b!==b&&a===a?1:0)},c.numcmp=function(a,b){return a-b},c.stablesort=function(a,b,c){var d=a.reduce(function(a,b,d){return a[c(b)]=d,a},{});return a.sort(function(a,e){var f=b(a),g=b(e);return g>f?-1:f>g?1:d[c(a)]-d[c(e)]}),a},c.permute=function(a){for(var c,d,b=a.length;b;)d=Math.floor(Math.random()*b--),c=a[b],a[b]=a[d],a[d]=c},c.pad=function(a,b,c,d){d=d||" ";var e=b-a.length;if(0>=e)return a;switch(c){case"left":return g(e,d)+a;case"middle":case"center":return g(Math.floor(e/2),d)+a+g(Math.ceil(e/2),d);default:return a+g(e,d)}},c.truncate=function(a,b,c,d,e){var f=a.length;if(b>=f)return a;e=void 0!==e?String(e):"\u2026";var g=Math.max(0,b-e.length);switch(c){case"left":return e+(d?h(a,g,1):a.slice(f-g));case"middle":case"center":var i=Math.ceil(g/2),j=Math.floor(g/2);return(d?h(a,i):a.slice(0,i))+e+(d?h(a,j,1):a.slice(f-j));default:return(d?h(a,g):a.slice(0,g))+e}};var i=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,a("buffer").Buffer)},{buffer:1}],3:[function(a,b,c){var d="undefined"!=typeof JSON?JSON:a("jsonify");b.exports=function(a,b){b||(b={}),"function"==typeof b&&(b={cmp:b});var c=b.space||"";"number"==typeof c&&(c=Array(c+1).join(" "));var g="boolean"==typeof b.cycles?b.cycles:!1,h=b.replacer||function(a,b){return b},i=b.cmp&&function(a){return function(b){return function(c,d){var e={key:c,value:b[c]},f={key:d,value:b[d]};return a(e,f)}}}(b.cmp),j=[];return function k(a,b,l,m){var n=c?"\n"+new Array(m+1).join(c):"",o=c?": ":":";if(l&&l.toJSON&&"function"==typeof l.toJSON&&(l=l.toJSON()),l=h.call(a,b,l),void 0!==l){if("object"!=typeof l||null===l)return d.stringify(l);if(e(l)){for(var p=[],q=0;q<l.length;q++){var r=k(l,q,l[q],m+1)||d.stringify(null);p.push(n+c+r)}return"["+p.join(",")+n+"]"}if(-1!==j.indexOf(l)){if(g)return d.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}j.push(l);for(var s=f(l).sort(i&&i(l)),p=[],q=0;q<s.length;q++){var b=s[q],t=k(l,b,l[b],m+1);if(t){var u=d.stringify(b)+o+t;p.push(n+c+u)}}return j.splice(j.indexOf(l),1),"{"+p.join(",")+n+"}"}}({"":a},"",a,0)};var e=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},f=Object.keys||function(a){var b=Object.prototype.hasOwnProperty||function(){return!0},c=[];for(var d in a)b.call(a,d)&&c.push(d);return c}},{jsonify:4}],4:[function(a,b,c){c.parse=a("./lib/parse"),c.stringify=a("./lib/stringify")},{"./lib/parse":5,"./lib/stringify":6}],5:[function(a,b,c){var d,e,g,n,f={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},h=function(a){throw{name:"SyntaxError",message:a,at:d,text:g}},i=function(a){return a&&a!==e&&h("Expected '"+a+"' instead of '"+e+"'"),e=g.charAt(d),d+=1,e},j=function(){var a,b="";for("-"===e&&(b="-",i("-"));e>="0"&&"9">=e;)b+=e,i();if("."===e)for(b+=".";i()&&e>="0"&&"9">=e;)b+=e;if("e"===e||"E"===e)for(b+=e,i(),("-"===e||"+"===e)&&(b+=e,i());e>="0"&&"9">=e;)b+=e,i();return a=+b,isFinite(a)?a:void h("Bad number")},k=function(){var a,b,d,c="";if('"'===e)for(;i();){if('"'===e)return i(),c;if("\\"===e)if(i(),"u"===e){for(d=0,b=0;4>b&&(a=parseInt(i(),16),isFinite(a));b+=1)d=16*d+a;c+=String.fromCharCode(d)}else{if("string"!=typeof f[e])break;c+=f[e]}else c+=e}h("Bad string")},l=function(){for(;e&&" ">=e;)i()},m=function(){switch(e){case"t":return i("t"),i("r"),i("u"),i("e"),!0;case"f":return i("f"),i("a"),i("l"),i("s"),i("e"),!1;case"n":return i("n"),i("u"),i("l"),i("l"),null}h("Unexpected '"+e+"'")},o=function(){var a=[];if("["===e){if(i("["),l(),"]"===e)return i("]"),a;for(;e;){if(a.push(n()),l(),"]"===e)return i("]"),a;i(","),l()}}h("Bad array")},p=function(){var a,b={};if("{"===e){if(i("{"),l(),"}"===e)return i("}"),b;for(;e;){if(a=k(),l(),i(":"),Object.hasOwnProperty.call(b,a)&&h('Duplicate key "'+a+'"'),b[a]=n(),l(),"}"===e)return i("}"),b;i(","),l()}}h("Bad object")};n=function(){switch(l(),e){case"{":return p();case"[":return o();case'"':return k();case"-":return j();default:return e>="0"&&"9">=e?j():m()}},b.exports=function(a,b){var c;return g=a,d=0,e=" ",c=n(),l(),e&&h("Syntax error"),"function"==typeof b?function f(a,c){var d,e,g=a[c];if(g&&"object"==typeof g)for(d in g)Object.prototype.hasOwnProperty.call(g,d)&&(e=f(g,d),void 0!==e?g[d]=e:delete g[d]);return b.call(a,c,g)}({"":c},""):c}},{}],6:[function(a,b,c){function j(a){return e.lastIndex=0,e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function k(a,b){var c,d,e,h,m,l=f,n=b[a];switch(n&&"object"==typeof n&&"function"==typeof n.toJSON&&(n=n.toJSON(a)),"function"==typeof i&&(n=i.call(b,a,n)),typeof n){case"string":return j(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(f+=g,m=[],"[object Array]"===Object.prototype.toString.apply(n)){for(h=n.length,c=0;h>c;c+=1)m[c]=k(c,n)||"null";return e=0===m.length?"[]":f?"[\n"+f+m.join(",\n"+f)+"\n"+l+"]":"["+m.join(",")+"]",f=l,e}if(i&&"object"==typeof i)for(h=i.length,c=0;h>c;c+=1)d=i[c],"string"==typeof d&&(e=k(d,n),e&&m.push(j(d)+(f?": ":":")+e));else for(d in n)Object.prototype.hasOwnProperty.call(n,d)&&(e=k(d,n),e&&m.push(j(d)+(f?": ":":")+e));return e=0===m.length?"{}":f?"{\n"+f+m.join(",\n"+f)+"\n"+l+"}":"{"+m.join(",")+"}",f=l,e}}var f,g,i,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};b.exports=function(a,b,c){var d;if(f="",g="","number"==typeof c)for(d=0;c>d;d+=1)g+=" ";else"string"==typeof c&&(g=c);if(i=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return k("",{"":a})}},{}],7:[function(a,b,c){"use strict";!function(a){a[a.VALUES="values"]="VALUES",a[a.COUNT="count"]="COUNT",a[a.VALID="valid"]="VALID",a[a.MISSING="missing"]="MISSING",a[a.DISTINCT="distinct"]="DISTINCT",a[a.SUM="sum"]="SUM",a[a.MEAN="mean"]="MEAN",a[a.AVERAGE="average"]="AVERAGE",a[a.VARIANCE="variance"]="VARIANCE",a[a.VARIANCEP="variancep"]="VARIANCEP",a[a.STDEV="stdev"]="STDEV",a[a.STDEVP="stdevp"]="STDEVP",a[a.MEDIAN="median"]="MEDIAN",a[a.Q1="q1"]="Q1",a[a.Q3="q3"]="Q3",a[a.MODESKEW="modeskew"]="MODESKEW",a[a.MIN="min"]="MIN",a[a.MAX="max"]="MAX",a[a.ARGMIN="argmin"]="ARGMIN",a[a.ARGMAX="argmax"]="ARGMAX"}(c.AggregateOp||(c.AggregateOp={}));var d=c.AggregateOp;c.AGGREGATE_OPS=[d.VALUES,d.COUNT,d.VALID,d.MISSING,d.DISTINCT,d.SUM,d.MEAN,d.AVERAGE,d.VARIANCE,d.VARIANCEP,d.STDEV,d.STDEVP,d.MEDIAN,d.Q1,d.Q3,d.MODESKEW,d.MIN,d.MAX,d.ARGMIN,d.ARGMAX],c.SUM_OPS=[d.COUNT,d.SUM,d.DISTINCT],c.SHARED_DOMAIN_OPS=[d.MEAN,d.AVERAGE,d.STDEV,d.STDEVP,d.MEDIAN,d.Q1,d.Q3,d.MIN,d.MAX]},{}],8:[function(a,b,c){"use strict";!function(a){a[a.TOP="top"]="TOP",a[a.RIGHT="right"]="RIGHT",a[a.LEFT="left"]="LEFT",a[a.BOTTOM="bottom"]="BOTTOM"}(c.AxisOrient||(c.AxisOrient={}));c.AxisOrient;c.defaultAxisConfig={offset:void 0,grid:void 0,labels:!0,labelMaxLength:25,tickSize:void 0,characterWidth:6},c.defaultFacetAxisConfig={axisWidth:0,labels:!0,grid:!1,tickSize:0}},{}],9:[function(a,b,c){"use strict";function e(a){switch(a){case d.ROW:case d.COLUMN:case d.SIZE:case d.SHAPE:return 6;default:return 10}}var d=a("./channel");c.autoMaxBins=e},{"./channel":10}],10:[function(a,b,c){"use strict";function f(a,b){return!!g(a)[b]}function g(a){switch(a){case c.X:case c.Y:case c.COLOR:case c.DETAIL:case c.ORDER:case c.OPACITY:case c.ROW:case c.COLUMN:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case c.X2:case c.Y2:return{rule:!0,bar:!0,area:!0};case c.SIZE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,text:!0};case c.SHAPE:return{point:!0};case c.TEXT:return{text:!0};case c.PATH:return{line:!0}}return{}}function h(a){switch(a){case c.X:case c.Y:case c.COLOR:case c.OPACITY:case c.LABEL:case c.DETAIL:return{measure:!0,dimension:!0};case c.ROW:case c.COLUMN:case c.SHAPE:return{measure:!1,dimension:!0};case c.X2:case c.Y2:case c.SIZE:case c.TEXT:return{measure:!0,dimension:!1};case c.PATH:return{measure:!1,dimension:!0}}throw new Error("Invalid encoding channel"+a)}function i(a){return!d.contains([c.DETAIL,c.PATH,c.TEXT,c.LABEL,c.ORDER],a)}var d=a("./util");!function(a){a[a.X="x"]="X",a[a.Y="y"]="Y",a[a.X2="x2"]="X2",a[a.Y2="y2"]="Y2",a[a.ROW="row"]="ROW",a[a.COLUMN="column"]="COLUMN",a[a.SHAPE="shape"]="SHAPE",a[a.SIZE="size"]="SIZE",a[a.COLOR="color"]="COLOR",a[a.TEXT="text"]="TEXT",a[a.DETAIL="detail"]="DETAIL",a[a.LABEL="label"]="LABEL",a[a.PATH="path"]="PATH",a[a.ORDER="order"]="ORDER",a[a.OPACITY="opacity"]="OPACITY"}(c.Channel||(c.Channel={}));var e=c.Channel;c.X=e.X,c.Y=e.Y,c.X2=e.X2,c.Y2=e.Y2,c.ROW=e.ROW,c.COLUMN=e.COLUMN,c.SHAPE=e.SHAPE,c.SIZE=e.SIZE,c.COLOR=e.COLOR,c.TEXT=e.TEXT,c.DETAIL=e.DETAIL,c.LABEL=e.LABEL,c.PATH=e.PATH,c.ORDER=e.ORDER,c.OPACITY=e.OPACITY,c.CHANNELS=[c.X,c.Y,c.X2,c.Y2,c.ROW,c.COLUMN,c.SIZE,c.SHAPE,c.COLOR,c.PATH,c.ORDER,c.OPACITY,c.TEXT,c.DETAIL,c.LABEL],c.UNIT_CHANNELS=d.without(c.CHANNELS,[c.ROW,c.COLUMN]),c.UNIT_SCALE_CHANNELS=d.without(c.UNIT_CHANNELS,[c.PATH,c.ORDER,c.DETAIL,c.TEXT,c.LABEL,c.X2,c.Y2]),c.NONSPATIAL_CHANNELS=d.without(c.UNIT_CHANNELS,[c.X,c.Y,c.X2,c.Y2]),c.NONSPATIAL_SCALE_CHANNELS=d.without(c.UNIT_SCALE_CHANNELS,[c.X,c.Y,c.X2,c.Y2]),c.STACK_GROUP_CHANNELS=[c.COLOR,c.DETAIL,c.ORDER,c.OPACITY,c.SIZE],c.supportMark=f,c.getSupportedMark=g,c.getSupportedRole=h,c.hasScale=i},{"./util":60}],11:[function(a,b,c){"use strict";function j(a,b){return b.reduce(function(b,c){return a.axis(c)&&(b[c]=l(c,a)),b},{})}function k(a,b){var d=a===e.COLUMN,f=a===e.ROW,g=d?"x":f?"y":a,i={type:g,scale:b.scaleName(a),grid:!0,tickSize:0,properties:{labels:{text:{value:""}},axis:{stroke:{value:"transparent"}}}},j=b.axis(a);["layer","ticks","values","subdivide"].forEach(function(d){var e,f=(e=c[d])?e(b,a,i):j[d];void 0!==f&&(i[d]=f)});var k=b.axis(a).properties||{};return["grid"].forEach(function(c){var d=x[c]?x[c](b,a,k[c]||{},i):k[c];void 0!==d&&h.keys(d).length>0&&(i.properties=i.properties||{},i.properties[c]=d)}),i}function l(a,b){var d=a===e.COLUMN,f=a===e.ROW,g=d?"x":f?"y":a,i=b.axis(a),j={type:g,scale:b.scaleName(a)};["format","grid","layer","offset","orient","tickSize","ticks","tickSizeEnd","title","titleOffset","tickPadding","tickSize","tickSizeMajor","tickSizeMinor","values","subdivide"].forEach(function(d){var e,f=(e=c[d])?e(b,a,j):i[d];void 0!==f&&(j[d]=f)});var k=b.axis(a).properties||{};return["axis","labels","grid","title","ticks","majorTicks","minorTicks"].forEach(function(c){var d=x[c]?x[c](b,a,k[c]||{},j):k[c];void 0!==d&&h.keys(d).length>0&&(j.properties=j.properties||{},j.properties[c]=d)}),j}function m(a,b){return i.numberFormat(a.fieldDef(b),a.axis(b).format,a.config())}function n(a,b){return a.axis(b).offset}function o(a,b){var c=a.axis(b).grid;return void 0!==c?c:!a.isOrdinalScale(b)&&!a.fieldDef(b).bin}function p(a,b){return b===e.ROW||b===e.COLUMN?void 0:o(a,b)&&(b===e.Y||b===e.X)&&!(a.parent()&&a.parent().isFacet())}function q(a,b,c){var d=a.axis(b).layer;return void 0!==d?d:c.grid?"back":void 0}function r(a,b){var c=a.axis(b).orient;return c?c:b===e.COLUMN?d.AxisOrient.TOP:void 0}function s(a,b){var c=a.axis(b).ticks;return void 0!==c?c:b!==e.X||a.fieldDef(b).bin?void 0:5}function t(a,b){var c=a.axis(b).tickSize;return void 0!==c?c:void 0}function u(a,b){var c=a.axis(b).tickSizeEnd;return void 0!==c?c:void 0}function v(a,b){var c=a.axis(b);if(void 0!==c.title)return c.title;var g,d=f.title(a.fieldDef(b),a.config());if(c.titleMaxLength)g=c.titleMaxLength;else if(b!==e.X||a.isOrdinalScale(e.X)){if(b===e.Y&&!a.isOrdinalScale(e.Y)){var i=a;g=i.height/a.axis(e.Y).characterWidth}}else{var i=a;g=i.width/a.axis(e.X).characterWidth}return g?h.truncate(d,g):d}function w(a,b){var c=a.axis(b).titleOffset;return void 0!==c?c:void 0}var d=a("../axis"),e=a("../channel"),f=a("../fielddef"),g=a("../type"),h=a("../util"),i=a("./common");c.parseAxisComponent=j,c.parseInnerAxis=k,c.parseAxis=l,c.format=m,c.offset=n,c.gridShow=o,c.grid=p,c.layer=q,c.orient=r,c.ticks=s,c.tickSize=t,c.tickSizeEnd=u,c.title=v,c.titleOffset=w;var x;!function(a){function b(a,b,c){var d=a.axis(b);return h.extend(void 0!==d.axisColor?{stroke:{value:d.axisColor}}:{},void 0!==d.axisWidth?{strokeWidth:{value:d.axisWidth}}:{},c||{})}function c(a,b,c){var d=a.axis(b);return h.extend(void 0!==d.gridColor?{stroke:{value:d.gridColor}}:{},void 0!==d.gridOpacity?{strokeOpacity:{value:d.gridOpacity}}:{},void 0!==d.gridWidth?{strokeWidth:{value:d.gridWidth}}:{},void 0!==d.gridDash?{strokeDashOffset:{value:d.gridDash}}:{},c||{})}function d(a,b,c,d){var f=a.fieldDef(b),j=a.axis(b),k=a.config();return j.labels?(h.contains([g.NOMINAL,g.ORDINAL],f.type)&&j.labelMaxLength?c=h.extend({text:{template:'{{ datum["data"] | truncate:'+j.labelMaxLength+" }}"}},c||{}):f.type===g.TEMPORAL&&(c=h.extend({text:{template:i.timeTemplate('datum["data"]',f.timeUnit,j.format,j.shortTimeLabels,k)}},c)),void 0!==j.labelAngle?c.angle={value:j.labelAngle}:b===e.X&&(h.contains([g.NOMINAL,g.ORDINAL],f.type)||f.bin||f.type===g.TEMPORAL)&&(c.angle={value:270}),void 0!==j.labelAlign?c.align={value:j.labelAlign}:c.angle&&(270===c.angle.value?c.align={value:"top"===d.orient?"left":"x"===d.type?"right":"center"}:90===c.angle.value&&(c.align={value:"center"})),void 0!==j.labelBaseline?c.baseline={value:j.labelBaseline}:c.angle&&(270===c.angle.value?c.baseline={value:"x"===d.type?"middle":"bottom"}:90===c.angle.value&&(c.baseline={value:"bottom"})),void 0!==j.tickLabelColor&&(c.stroke={value:j.tickLabelColor}),void 0!==j.tickLabelFont&&(c.font={value:j.tickLabelFont}),void 0!==j.tickLabelFontSize&&(c.fontSize={value:j.tickLabelFontSize}),0===h.keys(c).length?void 0:c):h.extend({text:""},c)}function f(a,b,c){var d=a.axis(b);return h.extend(void 0!==d.tickColor?{stroke:{value:d.tickColor}}:{},void 0!==d.tickWidth?{strokeWidth:{value:d.tickWidth}}:{},c||{})}function j(a,b,c){var d=a.axis(b);return h.extend(void 0!==d.titleColor?{stroke:{value:d.titleColor}}:{},void 0!==d.titleFont?{font:{value:d.titleFont}}:{},void 0!==d.titleFontSize?{fontSize:{value:d.titleFontSize}}:{},void 0!==d.titleFontWeight?{fontWeight:{value:d.titleFontWeight}}:{},c||{})}a.axis=b,a.grid=c,a.labels=d,a.ticks=f,a.title=j}(x=c.properties||(c.properties={}))},{"../axis":8,"../channel":10,"../fielddef":48,"../type":59,"../util":60,"./common":12}],12:[function(a,b,c){"use strict";function p(a,b,c){return o.isFacetSpec(a)?new k.FacetModel(a,b,c):o.isLayerSpec(a)?new l.LayerModel(a,b,c):o.isUnitSpec(a)?new n.UnitModel(a,b,c):(console.error("Invalid spec."),null)}function q(a,b){var e=b.config().mark.filled,g=b.encoding().color,h=b.encoding().opacity;e?s(a,b,c.FILL_CONFIG):s(a,b,c.STROKE_CONFIG);var k,l;b.has(f.COLOR)?k={scale:b.scaleName(f.COLOR),field:b.field(f.COLOR,g.type===i.ORDINAL?{prefix:"rank"}:{})}:g&&g.value&&(k={value:g.value}),b.has(f.OPACITY)?l={scale:b.scaleName(f.OPACITY),field:b.field(f.OPACITY,h.type===i.ORDINAL?{prefix:"rank"}:{})}:h&&h.value&&(l={value:h.value}),void 0!==k?e?a.fill=k:a.stroke=k:a[e?"fill":"stroke"]=a[e?"fill":"stroke"]||{value:b.config().mark.color},!a.fill&&j.contains([d.BAR,d.POINT,d.CIRCLE,d.SQUARE],b.mark())&&(a.fill={value:"transparent"}),void 0!==l&&(a.opacity=l)}function r(a,b,c){return c.forEach(function(c){var d=b[c];void 0!==d&&(a[c]={value:d})}),a}function s(a,b,c){return r(a,b.config().mark,c)}function t(a,b,c){return a.type!==i.QUANTITATIVE||a.bin?void 0:b?b:a.aggregate===e.AggregateOp.COUNT?"d":c.numberFormat}function u(a){return(a.sort===h.SortOrder.DESCENDING?"-":"")+g.field(a,{binSuffix:"mid"})}function v(a,b,c,d,e){if(!b||c){var f=c||e.timeFormat;return"{{"+a+" | time:'"+f+"'}}"}return m.template(b,a,d)}var d=a("../mark"),e=a("../aggregate"),f=a("../channel"),g=a("../fielddef"),h=a("../sort"),i=a("../type"),j=a("../util"),k=a("./facet"),l=a("./layer"),m=a("../timeunit"),n=a("./unit"),o=a("../spec");c.buildModel=p,c.STROKE_CONFIG=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","opacity"],c.FILL_CONFIG=["fill","fillOpacity","opacity"],c.FILL_STROKE_CONFIG=j.union(c.STROKE_CONFIG,c.FILL_CONFIG),c.applyColorAndOpacity=q,c.applyConfig=r,c.applyMarkConfig=s,c.numberFormat=t,c.sortField=u,c.timeTemplate=v},{"../aggregate":7,"../channel":10,"../fielddef":48,"../mark":51,"../sort":54,"../spec":55,"../timeunit":57,"../type":59,"../util":60,"./facet":28,"./layer":29,"./unit":42}],13:[function(a,b,c){"use strict";function h(a){var b=e.normalize(a),c=g.buildModel(b,null,"");return c.parse(),i(c)}function i(a){var b=a.config(),c=f.extend({width:1,height:1,padding:"auto"},b.viewport?{viewport:b.viewport}:{},b.background?{background:b.background}:{},{data:[].concat(a.assembleData([]),a.assembleLayout([])),marks:[j(a)]});return{spec:c}}function j(a){var b=f.extend({name:a.name("root"),type:"group"},a.description()?{description:a.description()}:{},{from:{data:d.LAYOUT},properties:{update:f.extend({width:{field:"width"},height:{field:"height"}},a.assembleParentGroupProperties(a.config().cell))}});return f.extend(b,a.assembleGroup())}var d=a("../data"),e=a("../spec"),f=a("../util"),g=a("./common");c.compile=h,c.assembleRootGroup=j},{"../data":44,"../spec":55,"../util":60,"./common":12}],14:[function(a,b,c){"use strict";function l(a,b,c){return j.extend(["filled","opacity","orient","align"].reduce(function(e,g){var i=c.mark[g];switch(g){case"filled":void 0===i&&(e[g]=a!==h.POINT&&a!==h.LINE&&a!==h.RULE);break;case"opacity":void 0===i&&(j.contains([h.POINT,h.TICK,h.CIRCLE,h.SQUARE],a)&&(!f.isAggregate(b)||f.has(b,d.DETAIL))&&(e[g]=.7),a===h.AREA&&(e[g]=.7));break;case"orient":e[g]=m(a,b,c.mark);break;case"align":void 0===i&&(e[g]=f.has(b,d.X)?"center":"right")}return e},{}),c.mark)}function m(a,b,c){switch(void 0===c&&(c={}),a){case h.POINT:case h.CIRCLE:case h.SQUARE:case h.TEXT:return void 0}var f=b.y&&b.y2,j=b.x&&b.x2;switch(a){case h.TICK:var l=b.x?k.scaleType(b.x.scale||{},b.x,d.X,a):null,m=b.y?k.scaleType(b.y.scale||{},b.y,d.Y,a):null;return l===i.ScaleType.ORDINAL||b.y&&m!==i.ScaleType.ORDINAL?e.Orient.HORIZONTAL:e.Orient.VERTICAL;case h.RULE:return j?e.Orient.HORIZONTAL:f?e.Orient.VERTICAL:b.y?e.Orient.HORIZONTAL:b.x?e.Orient.VERTICAL:void 0;case h.BAR:case h.AREA:if(f)return e.Orient.VERTICAL;if(j)return e.Orient.HORIZONTAL;case h.LINE:var n=g.isMeasure(b.x)||g.isMeasure(b.x2),o=g.isMeasure(b.y)||g.isMeasure(b.y2);return n&&!o?e.Orient.HORIZONTAL:e.Orient.VERTICAL}return console.warn("orient unimplemented for mark",a),e.Orient.VERTICAL}var d=a("../channel"),e=a("../config"),f=a("../encoding"),g=a("../fielddef"),h=a("../mark"),i=a("../scale"),j=a("../util"),k=a("../compile/scale");c.initMarkConfig=l,c.orient=m},{"../channel":10,"../compile/scale":41,"../config":43,"../encoding":46,"../fielddef":48,"../mark":51,"../scale":52,"../util":60}],15:[function(a,b,c){"use strict";var h,d=a("../../bin"),e=a("../../channel"),f=a("../../fielddef"),g=a("../../util");!function(a){function b(a){return a.reduce(function(b,c,h){var i=a.fieldDef(h).bin;if(i){var j=g.extend({type:"bin",field:c.field,output:{start:f.field(c,{binSuffix:"start"}),mid:f.field(c,{binSuffix:"mid"}),end:f.field(c,{binSuffix:"end"})}},"boolean"==typeof i?{}:i);j.maxbins||j.step||(j.maxbins=d.autoMaxBins(h));var k=[j],l=a.isOrdinalScale(h)||h===e.COLOR;l&&k.push({type:"formula",field:f.field(c,{binSuffix:"range"}),expr:f.field(c,{datum:!0,binSuffix:"start"})+" + '-' + "+f.field(c,{datum:!0,binSuffix:"end"})});var m=g.hash(i)+"_"+c.field+"oc:"+l;b[m]=k}return b},{})}function c(a){var c=b(a),d=a.child().component.data;return d.source||(g.extend(c,d.bin),delete d.bin),c}function h(a){var c=b(a);return a.children().forEach(function(a){var b=a.component.data;b.source||(g.extend(c,b.bin),delete b.bin)}),c}function i(a){return g.flatten(g.vals(a.bin))}a.parseUnit=b,a.parseFacet=c,a.parseLayer=h,a.assemble=i}(h=c.bin||(c.bin={}))},{"../../bin":9,"../../channel":10,"../../fielddef":48,"../../util":60}],16:[function(a,b,c){"use strict";var g,d=a("../../channel"),e=a("../../type"),f=a("../../util");!function(a){function b(a){var b={};return a.has(d.COLOR)&&a.encoding().color.type===e.ORDINAL&&(b[a.field(d.COLOR)]=[{type:"sort",by:a.field(d.COLOR)},{type:"rank",field:a.field(d.COLOR),output:{rank:a.field(d.COLOR,{prefix:"rank"})}}]),b}function c(a){var b=a.child().component.data;if(!b.source){var c=b.colorRank;return delete b.colorRank,c}return{}}function g(a){var b={};return a.children().forEach(function(a){var c=a.component.data;c.source||(f.extend(b,c.colorRank),delete c.colorRank)}),b}function h(a){return f.flatten(f.vals(a.colorRank))}a.parseUnit=b,a.parseFacet=c,a.parseLayer=g,a.assemble=h}(g=c.colorRank||(c.colorRank={}))},{"../../channel":10,"../../type":59,"../../util":60}],17:[function(a,b,c){"use strict";function q(a){return{formatParse:f.formatParse.parseUnit(a),nullFilter:g.nullFilter.parseUnit(a),filter:h.filter.parseUnit(a),nonPositiveFilter:k.nonPositiveFilter.parseUnit(a),source:e.source.parseUnit(a),bin:i.bin.parseUnit(a),calculate:j.formula.parseUnit(a),timeUnit:n.timeUnit.parseUnit(a),timeUnitDomain:o.timeUnitDomain.parseUnit(a),summary:l.summary.parseUnit(a),stackScale:m.stackScale.parseUnit(a),colorRank:p.colorRank.parseUnit(a)}}function r(a){return{formatParse:f.formatParse.parseFacet(a),nullFilter:g.nullFilter.parseFacet(a),filter:h.filter.parseFacet(a),nonPositiveFilter:k.nonPositiveFilter.parseFacet(a),source:e.source.parseFacet(a),bin:i.bin.parseFacet(a),calculate:j.formula.parseFacet(a),timeUnit:n.timeUnit.parseFacet(a),timeUnitDomain:o.timeUnitDomain.parseFacet(a),summary:l.summary.parseFacet(a),stackScale:m.stackScale.parseFacet(a),colorRank:p.colorRank.parseFacet(a)}}function s(a){return{filter:h.filter.parseLayer(a),formatParse:f.formatParse.parseLayer(a),nullFilter:g.nullFilter.parseLayer(a),nonPositiveFilter:k.nonPositiveFilter.parseLayer(a),source:e.source.parseLayer(a),bin:i.bin.parseLayer(a),calculate:j.formula.parseLayer(a),timeUnit:n.timeUnit.parseLayer(a),timeUnitDomain:o.timeUnitDomain.parseLayer(a),summary:l.summary.parseLayer(a),stackScale:m.stackScale.parseLayer(a),colorRank:p.colorRank.parseLayer(a)}}function t(a,b){var c=a.component.data,f=e.source.assemble(a,c);if(f&&b.push(f),l.summary.assemble(c,a).forEach(function(a){b.push(a)}),b.length>0){var g=b[b.length-1],h=p.colorRank.assemble(c);h.length>0&&(g.transform=(g.transform||[]).concat(h));var i=k.nonPositiveFilter.assemble(c);i.length>0&&(g.transform=(g.transform||[]).concat(i))}else{if(d.keys(c.colorRank).length>0)throw new Error("Invalid colorRank not merged");if(d.keys(c.nonPositiveFilter).length>0)throw new Error("Invalid nonPositiveFilter not merged")}var j=m.stackScale.assemble(c);return j&&b.push(j),o.timeUnitDomain.assemble(c).forEach(function(a){b.push(a)}),b}var d=a("../../util"),e=a("./source"),f=a("./formatparse"),g=a("./nullfilter"),h=a("./filter"),i=a("./bin"),j=a("./formula"),k=a("./nonpositivenullfilter"),l=a("./summary"),m=a("./stackscale"),n=a("./timeunit"),o=a("./timeunitdomain"),p=a("./colorrank");c.parseUnitData=q,c.parseFacetData=r,c.parseLayerData=s,c.assembleData=t},{"../../util":60,"./bin":15,"./colorrank":16,"./filter":18,"./formatparse":19,"./formula":20,"./nonpositivenullfilter":21,"./nullfilter":22,"./source":23,"./stackscale":24,"./summary":25,"./timeunit":26,"./timeunitdomain":27}],18:[function(a,b,c){"use strict";var f,d=a("../../filter"),e=a("../../util");!function(a){function b(a){var b=a.transform().filter;return e.isArray(b)?"("+b.map(function(a){return d.expression(a)}).filter(function(a){return void 0!==a}).join(") && (")+")":b?d.expression(b):void 0}function c(a){var c=b(a),d=a.child().component.data;return!d.source&&d.filter&&(c=(c?c+" && ":"")+d.filter,delete d.filter),c}function f(a){var c=b(a);return a.children().forEach(function(b){var d=b.component.data;a.compatibleSource(b)&&d.filter&&d.filter===c&&delete d.filter}),c}function g(a){var b=a.filter;return b?[{type:"filter",test:b}]:[]}a.parse=b,a.parseUnit=b,a.parseFacet=c,a.parseLayer=f,a.assemble=g}(f=c.filter||(c.filter={}))},{"../../filter":49,"../../util":60}],19:[function(a,b,c){"use strict";var g,d=a("../../fielddef"),e=a("../../type"),f=a("../../util");!function(a){function b(a){var b=(a.transform().calculate||[]).reduce(function(a,b){return a[b.field]=!0,a},{}),c={};return a.forEach(function(a){if(a.type===e.TEMPORAL)c[a.field]="date";else if(a.type===e.QUANTITATIVE){if(d.isCount(a)||b[a.field])return;c[a.field]="number"}}),c}function c(a){var c=b(a),d=a.child().component.data;return!d.source&&d.formatParse&&(f.extend(c,d.formatParse),delete d.formatParse),c}function g(a){var c=b(a);return a.children().forEach(function(b){var d=b.component.data;a.compatibleSource(b)&&!f.differ(d.formatParse,c)&&(f.extend(c,d.formatParse),delete d.formatParse)}),c}a.parseUnit=b,a.parseFacet=c,a.parseLayer=g}(g=c.formatParse||(c.formatParse={}))},{"../../fielddef":48,"../../type":59,"../../util":60}],20:[function(a,b,c){"use strict";var e,d=a("../../util");!function(a){function b(a){return(a.transform().calculate||[]).reduce(function(a,b){return a[d.hash(b)]=b,a},{})}function c(a){var c=b(a),e=a.child().component.data;return e.source||(d.extend(c,e.calculate),delete e.calculate),c}function e(a){var c=b(a);return a.children().forEach(function(a){var b=a.component.data;!b.source&&b.calculate&&(d.extend(c||{},b.calculate),delete b.calculate)}),c}function f(a){return d.vals(a.calculate).reduce(function(a,b){return a.push(d.extend({type:"formula"},b)),a},[])}a.parseUnit=b,a.parseFacet=c,a.parseLayer=e,a.assemble=f}(e=c.formula||(c.formula={}))},{"../../util":60}],21:[function(a,b,c){"use strict";var f,d=a("../../scale"),e=a("../../util");!function(a){function b(a){return a.channels().reduce(function(b,c){var e=a.scale(c);return a.field(c)&&e?(b[a.field(c)]=e.type===d.ScaleType.LOG,b):b},{})}function c(a){var b=a.child().component.data;if(!b.source){var c=b.nonPositiveFilter;return delete b.nonPositiveFilter,c}return{}}function f(a){var b={};return a.children().forEach(function(c){var d=c.component.data;a.compatibleSource(c)&&!e.differ(d.nonPositiveFilter,b)&&(e.extend(b,d.nonPositiveFilter),delete d.nonPositiveFilter)}),b}function g(a){return e.keys(a.nonPositiveFilter).filter(function(b){return a.nonPositiveFilter[b]}).map(function(a){return{type:"filter",test:'datum["'+a+'"] > 0'}})}a.parseUnit=b,a.parseFacet=c,a.parseLayer=f,a.assemble=g}(f=c.nonPositiveFilter||(c.nonPositiveFilter={}))},{"../../scale":52,"../../util":60}],22:[function(a,b,c){"use strict";var g,d=a("../../type"),e=a("../../util"),f={nominal:!1,ordinal:!1,quantitative:!0,temporal:!0};!function(a){function b(a){var b=a.transform(),c=b.filterInvalid;return void 0===c&&void 0!==b.filterNull&&(c=b.filterNull,console.warn("filterNull is deprecated. Please use filterInvalid instead.")),a.reduce(function(a,b){return"*"!==b.field&&(c||void 0===c&&b.field&&f[b.type]?a[b.field]=b:a[b.field]=null),a},{})}function c(a){var c=b(a),d=a.child().component.data;return d.source||(e.extend(c,d.nullFilter),delete d.nullFilter),c}function g(a){var c=b(a);return a.children().forEach(function(b){var d=b.component.data;a.compatibleSource(b)&&!e.differ(d.nullFilter,c)&&(e.extend(c,d.nullFilter),delete d.nullFilter)}),c}function h(a){var b=e.keys(a.nullFilter).reduce(function(b,c){var f=a.nullFilter[c];return null!==f&&(b.push('datum["'+f.field+'"] !== null'),e.contains([d.QUANTITATIVE,d.TEMPORAL],f.type)&&b.push('!isNaN(datum["'+f.field+'"])')),b},[]);return b.length>0?[{type:"filter",test:b.join(" && ")}]:[]}a.parseUnit=b,a.parseFacet=c,a.parseLayer=g,
a.assemble=h}(g=c.nullFilter||(c.nullFilter={}))},{"../../type":59,"../../util":60}],23:[function(a,b,c){"use strict";var k,d=a("../../data"),e=a("../../util"),f=a("./nullfilter"),g=a("./filter"),h=a("./bin"),i=a("./formula"),j=a("./timeunit");!function(a){function b(a){var b=a.data();if(b){var c={name:a.dataName(d.SOURCE)};if(b.values&&b.values.length>0)c.values=b.values,c.format={type:"json"};else if(b.url){c.url=b.url;var f=/(?:\.([^.]+))?$/.exec(c.url)[1];e.contains(["json","csv","tsv","topojson"],f)||(f="json");var g=b.format||{},h=g.type||b.formatType;c.format=e.extend({type:h?h:f},g.property?{property:g.property}:{},g.feature?{feature:g.feature}:g.mesh?{mesh:g.mesh}:{})}return c}return a.parent()?void 0:{name:a.dataName(d.SOURCE)}}function c(a){var c=b(a);return a.child().component.data.source||a.child().renameData(a.child().dataName(d.SOURCE),a.dataName(d.SOURCE)),c}function k(a){var c=b(a);return a.children().forEach(function(b){var c=b.component.data;if(a.compatibleSource(b)){var e=!c.filter&&!c.formatParse&&!c.nullFilter;e?(b.renameData(b.dataName(d.SOURCE),a.dataName(d.SOURCE)),delete c.source):c.source={name:b.dataName(d.SOURCE),source:a.dataName(d.SOURCE)}}}),c}function l(a,b){if(b.source){var c=b.source;return b.formatParse&&(b.source.format=b.source.format||{},b.source.format.parse=b.formatParse),c.transform=[].concat(i.formula.assemble(b),f.nullFilter.assemble(b),g.filter.assemble(b),h.bin.assemble(b),j.timeUnit.assemble(b)),c}return null}a.parseUnit=b,a.parseFacet=c,a.parseLayer=k,a.assemble=l}(k=c.source||(c.source={}))},{"../../data":44,"../../util":60,"./bin":15,"./filter":18,"./formula":20,"./nullfilter":22,"./timeunit":26}],24:[function(a,b,c){"use strict";var g,d=a("../../data"),e=a("../../fielddef"),f=a("../../util");!function(a){function b(a){var b=a.stack();if(b){var c=b.groupbyChannel,e=b.fieldChannel,g=[],h=a.field(c);return h&&g.push(h),{name:a.dataName(d.STACKED_SCALE),source:a.dataName(d.SUMMARY),transform:[f.extend({type:"aggregate",summarize:[{ops:["sum"],field:a.field(e)}]},g.length>0?{groupby:g}:{})]}}return null}function c(a){var b=a.child(),c=b.component.data;if(!c.source&&c.stackScale){var f=c.stackScale,g=a.dataName(d.STACKED_SCALE);return b.renameData(f.name,g),f.name=g,f.source=a.dataName(d.SUMMARY),f.transform[0].groupby=a.reduce(function(a,b){return a.push(e.field(b)),a},f.transform[0].groupby),delete c.stackScale,f}return null}function g(a){return null}function h(a){return a.stackScale}a.parseUnit=b,a.parseFacet=c,a.parseLayer=g,a.assemble=h}(g=c.stackScale||(c.stackScale={}))},{"../../data":44,"../../fielddef":48,"../../util":60}],25:[function(a,b,c){"use strict";var h,d=a("../../aggregate"),e=a("../../data"),f=a("../../fielddef"),g=a("../../util");!function(a){function b(a,b){return b.bin?(a[f.field(b,{binSuffix:"start"})]=!0,a[f.field(b,{binSuffix:"mid"})]=!0,a[f.field(b,{binSuffix:"end"})]=!0,a[f.field(b,{binSuffix:"range"})]=!0):a[f.field(b)]=!0,a}function c(a){var c={},f={};return a.forEach(function(a,e){a.aggregate?a.aggregate===d.AggregateOp.COUNT?(f["*"]=f["*"]||{},f["*"].count=!0):(f[a.field]=f[a.field]||{},f[a.field][a.aggregate]=!0):b(c,a)}),[{name:a.dataName(e.SUMMARY),dimensions:c,measures:f}]}function h(a){var c=a.child().component.data;if(!c.source&&c.summary){var d=c.summary.map(function(c){c.dimensions=a.reduce(b,c.dimensions);var d=c.name.substr(a.child().name("").length);return a.child().renameData(c.name,d),c.name=d,c});return delete c.summary,d}return[]}function i(a,b){for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];for(var e in d)d.hasOwnProperty(e)&&(c in a?a[c][e]=!0:a[c]={op:!0})}}function j(a){var b={};return a.children().forEach(function(c){var d=c.component.data;!d.source&&d.summary&&d.summary.forEach(function(f){var h=g.hash(f.dimensions);h in b?i(b[h].measures,f.measures):(f.name=a.dataName(e.SUMMARY)+"_"+g.keys(b).length,b[h]=f),c.renameData(c.dataName(e.SUMMARY),b[h].name),delete d.summary})}),g.vals(b)}function k(a,b){return a.summary?a.summary.reduce(function(a,c){var d=c.dimensions,f=c.measures,h=g.keys(d),i=g.reduce(f,function(a,b,c){return a[c]=g.keys(b),a},{});return g.keys(f).length>0&&a.push({name:c.name,source:b.dataName(e.SOURCE),transform:[{type:"aggregate",groupby:h,summarize:i}]}),a},[]):[]}a.parseUnit=c,a.parseFacet=h,a.parseLayer=j,a.assemble=k}(h=c.summary||(c.summary={}))},{"../../aggregate":7,"../../data":44,"../../fielddef":48,"../../util":60}],26:[function(a,b,c){"use strict";var h,d=a("../../fielddef"),e=a("../../timeunit"),f=a("../../type"),g=a("../../util");!function(a){function b(a){return a.reduce(function(a,b,c){if(b.type===f.TEMPORAL&&b.timeUnit){var g=d.field(b);a[g]={type:"formula",field:d.field(b),expr:e.fieldExpr(b.timeUnit,b.field)}}return a},{})}function c(a){var c=b(a),d=a.child().component.data;return d.source||(g.extend(c,d.timeUnit),delete d.timeUnit),c}function h(a){var c=b(a);return a.children().forEach(function(a){var b=a.component.data;b.source||(g.extend(c,b.timeUnit),delete b.timeUnit)}),c}function i(a){return g.vals(a.timeUnit)}a.parseUnit=b,a.parseFacet=c,a.parseLayer=h,a.assemble=i}(h=c.timeUnit||(c.timeUnit={}))},{"../../fielddef":48,"../../timeunit":57,"../../type":59,"../../util":60}],27:[function(a,b,c){"use strict";var g,d=a("../../datetime"),e=a("../../timeunit"),f=a("../../util");!function(a){function b(a){return a.reduce(function(a,b,c){if(b.timeUnit){var d=e.rawDomain(b.timeUnit,c);d&&(a[b.timeUnit]=!0)}return a},{})}function c(a){return f.extend(b(a),a.child().component.data.timeUnitDomain)}function g(a){return f.extend(b(a),a.children().forEach(function(a){return a.component.data.timeUnitDomain}))}function h(a){return f.keys(a.timeUnitDomain).reduce(function(a,b){var c=b,f=e.rawDomain(c,null);if(f){var g={};g[c]='datum["data"]',a.push({name:c,values:f,transform:[{type:"formula",field:"date",expr:d.dateTimeExpr(g)}]})}return a},[])}a.parseUnit=b,a.parseFacet=c,a.parseLayer=g,a.assemble=h}(g=c.timeUnitDomain||(c.timeUnitDomain={}))},{"../../datetime":45,"../../timeunit":57,"../../util":60}],28:[function(a,b,c){"use strict";function u(a){var b=a.child(),c=m.extend({},b.config().cell,b.config().facet.cell);return m.extend({x:a.has(f.COLUMN)?{scale:a.scaleName(f.COLUMN),field:a.field(f.COLUMN),offset:a.scale(f.COLUMN).padding/2}:{value:a.config().facet.scale.padding/2},y:a.has(f.ROW)?{scale:a.scaleName(f.ROW),field:a.field(f.ROW),offset:a.scale(f.ROW).padding/2}:{value:a.config().facet.scale.padding/2},width:{field:{parent:a.child().sizeName("width")}},height:{field:{parent:a.child().sizeName("height")}}},b.assembleParentGroupProperties(c))}function v(a,b){var c=null,d=a.child();return d.has(b)&&d.axis(b)&&(c=b===f.X?w(a):x(a),d.axis(b)&&n.gridShow(d,b)?d.component.axis[b]=n.parseInnerAxis(b,d):delete d.component.axis[b]),c}function w(a){var b=a.has(f.COLUMN);return m.extend({name:a.name("x-axes"),type:"group"},b?{from:{data:a.dataTable(),transform:[{type:"aggregate",groupby:[a.field(f.COLUMN)],summarize:{"*":["count"]}}]}}:{},{properties:{update:{width:{field:{parent:a.child().sizeName("width")}},height:{field:{group:"height"}},x:b?{scale:a.scaleName(f.COLUMN),field:a.field(f.COLUMN),offset:a.scale(f.COLUMN).padding/2}:{value:a.config().facet.scale.padding/2}}},axes:[n.parseAxis(f.X,a.child())]})}function x(a){var b=a.has(f.ROW);return m.extend({name:a.name("y-axes"),type:"group"},b?{from:{data:a.dataTable(),transform:[{type:"aggregate",groupby:[a.field(f.ROW)],summarize:{"*":["count"]}}]}}:{},{properties:{update:{width:{field:{group:"width"}},height:{field:{parent:a.child().sizeName("height")}},y:b?{scale:a.scaleName(f.ROW),field:a.field(f.ROW),offset:a.scale(f.ROW).padding/2}:{value:a.config().facet.scale.padding/2}}},axes:[n.parseAxis(f.Y,a.child())]})}function y(a){var b=a.config().facet.grid,c={name:a.name("row-grid"),type:"rule",from:{data:a.dataTable(),transform:[{type:"facet",groupby:[a.field(f.ROW)]}]},properties:{update:{y:{scale:a.scaleName(f.ROW),field:a.field(f.ROW)},x:{value:0,offset:-b.offset},x2:{field:{group:"width"},offset:b.offset},stroke:{value:b.color},strokeOpacity:{value:b.opacity},strokeWidth:{value:.5}}}};return[c,{name:a.name("row-grid-end"),type:"rule",properties:{update:{y:{field:{group:"height"}},x:{value:0,offset:-b.offset},x2:{field:{group:"width"},offset:b.offset},stroke:{value:b.color},strokeOpacity:{value:b.opacity},strokeWidth:{value:.5}}}}]}function z(a){var b=a.config().facet.grid,c={name:a.name("column-grid"),type:"rule",from:{data:a.dataTable(),transform:[{type:"facet",groupby:[a.field(f.COLUMN)]}]},properties:{update:{x:{scale:a.scaleName(f.COLUMN),field:a.field(f.COLUMN)},y:{value:0,offset:-b.offset},y2:{field:{group:"height"},offset:b.offset},stroke:{value:b.color},strokeOpacity:{value:b.opacity},strokeWidth:{value:.5}}}};return[c,{name:a.name("column-grid-end"),type:"rule",properties:{update:{x:{field:{group:"width"}},y:{value:0,offset:-b.offset},y2:{field:{group:"height"},offset:b.offset},stroke:{value:b.color},strokeOpacity:{value:b.opacity},strokeWidth:{value:.5}}}}]}var d=this&&this.__extends||function(a,b){function d(){this.constructor=a}for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)},e=a("../axis"),f=a("../channel"),g=a("../config"),h=a("../data"),i=a("../encoding"),j=a("../fielddef"),k=a("../scale"),l=a("../type"),m=a("../util"),n=a("./axis"),o=a("./common"),p=a("./data/data"),q=a("./layout"),r=a("./model"),s=a("./scale"),t=function(a){function b(b,c,d){a.call(this,b,c,d);var e=this._config=this._initConfig(b.config,c),f=this._child=o.buildModel(b.spec,this,this.name("child")),g=this._facet=this._initFacet(b.facet);this._scale=this._initScale(g,e,f),this._axis=this._initAxis(g,e,f)}return d(b,a),b.prototype._initConfig=function(a,b){return m.mergeDeep(m.duplicate(g.defaultConfig),a,b?b.config():{})},b.prototype._initFacet=function(a){a=m.duplicate(a);var b=this;return i.channelMappingForEach(this.channels(),a,function(a,c){j.isDimension(a)||b.addWarning(c+" encoding should be ordinal."),a.type&&(a.type=l.getFullName(a.type))}),a},b.prototype._initScale=function(a,b,c){return[f.ROW,f.COLUMN].reduce(function(d,e){if(a[e]){var g=a[e].scale||{};d[e]=m.extend({type:k.ScaleType.ORDINAL,round:b.facet.scale.round,padding:e===f.ROW&&c.has(f.Y)||e===f.COLUMN&&c.has(f.X)?b.facet.scale.padding:0},g)}return d},{})},b.prototype._initAxis=function(a,b,c){return[f.ROW,f.COLUMN].reduce(function(d,g){if(a[g]){var h=a[g].axis;if(h!==!1){var i=d[g]=m.extend({},b.facet.axis,h===!0?{}:h||{});if(g===f.ROW){var j=c.axis(f.Y);j&&j.orient!==e.AxisOrient.RIGHT&&!i.orient&&(i.orient=e.AxisOrient.RIGHT),c.has(f.X)&&!i.labelAngle&&(i.labelAngle=i.orient===e.AxisOrient.RIGHT?90:270)}}}return d},{})},b.prototype.facet=function(){return this._facet},b.prototype.has=function(a){return!!this._facet[a]},b.prototype.child=function(){return this._child},b.prototype.hasSummary=function(){for(var a=this.component.data.summary,b=0;b<a.length;b++)if(m.keys(a[b].measures).length>0)return!0;return!1},b.prototype.dataTable=function(){return(this.hasSummary()?h.SUMMARY:h.SOURCE)+""},b.prototype.fieldDef=function(a){return this.facet()[a]},b.prototype.stack=function(){return null},b.prototype.parseData=function(){this.child().parseData(),this.component.data=p.parseFacetData(this)},b.prototype.parseSelectionData=function(){},b.prototype.parseLayoutData=function(){this.child().parseLayoutData(),this.component.layout=q.parseFacetLayout(this)},b.prototype.parseScale=function(){var a=this.child(),b=this;a.parseScale();var c=this.component.scale=s.parseScaleComponent(this);m.keys(a.component.scale).forEach(function(d){c[d]=a.component.scale[d],m.vals(c[d]).forEach(function(c){var d=c.name.substr(a.name("").length),e=b.scaleName(d);a.renameScale(c.name,e),c.name=e}),delete a.component.scale[d]})},b.prototype.parseMark=function(){this.child().parseMark(),this.component.mark=m.extend({name:this.name("cell"),type:"group",from:m.extend(this.dataTable()?{data:this.dataTable()}:{},{transform:[{type:"facet",groupby:[].concat(this.has(f.ROW)?[this.field(f.ROW)]:[],this.has(f.COLUMN)?[this.field(f.COLUMN)]:[])}]}),properties:{update:u(this)}},this.child().assembleGroup())},b.prototype.parseAxis=function(){this.child().parseAxis(),this.component.axis=n.parseAxisComponent(this,[f.ROW,f.COLUMN])},b.prototype.parseAxisGroup=function(){var a=v(this,f.X),b=v(this,f.Y);this.component.axisGroup=m.extend(a?{x:a}:{},b?{y:b}:{})},b.prototype.parseGridGroup=function(){var a=this.child();this.component.gridGroup=m.extend(!a.has(f.X)&&this.has(f.COLUMN)?{column:z(this)}:{},!a.has(f.Y)&&this.has(f.ROW)?{row:y(this)}:{})},b.prototype.parseLegend=function(){this.child().parseLegend(),this.component.legend=this._child.component.legend,this._child.component.legend={}},b.prototype.assembleParentGroupProperties=function(){return null},b.prototype.assembleData=function(a){return p.assembleData(this,a),this._child.assembleData(a)},b.prototype.assembleLayout=function(a){return this._child.assembleLayout(a),q.assembleLayout(this,a)},b.prototype.assembleMarks=function(){return[].concat(m.vals(this.component.axisGroup),m.flatten(m.vals(this.component.gridGroup)),this.component.mark)},b.prototype.channels=function(){return[f.ROW,f.COLUMN]},b.prototype.mapping=function(){return this.facet()},b.prototype.isFacet=function(){return!0},b}(r.Model);c.FacetModel=t},{"../axis":8,"../channel":10,"../config":43,"../data":44,"../encoding":46,"../fielddef":48,"../scale":52,"../type":59,"../util":60,"./axis":11,"./common":12,"./data/data":17,"./layout":30,"./model":40,"./scale":41}],29:[function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function d(){this.constructor=a}for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)},e=a("../util"),f=a("../config"),g=a("./data/data"),h=a("./layout"),i=a("./model"),j=a("./common"),k=a("../vega.schema"),l=function(a){function b(b,c,d){var e=this;a.call(this,b,c,d),this._width=b.width,this._height=b.height,this._config=this._initConfig(b.config,c),this._children=b.layers.map(function(a,b){return j.buildModel(a,e,e.name("layer_"+b))})}return d(b,a),b.prototype._initConfig=function(a,b){return e.mergeDeep(e.duplicate(f.defaultConfig),a,b?b.config():{})},Object.defineProperty(b.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),b.prototype.has=function(a){return!1},b.prototype.children=function(){return this._children},b.prototype.isOrdinalScale=function(a){return this._children[0].isOrdinalScale(a)},b.prototype.dataTable=function(){return this._children[0].dataTable()},b.prototype.fieldDef=function(a){return null},b.prototype.stack=function(){return null},b.prototype.parseData=function(){this._children.forEach(function(a){a.parseData()}),this.component.data=g.parseLayerData(this)},b.prototype.parseSelectionData=function(){},b.prototype.parseLayoutData=function(){this._children.forEach(function(a,b){a.parseLayoutData()}),this.component.layout=h.parseLayerLayout(this)},b.prototype.parseScale=function(){var a=this,b=this.component.scale={};this._children.forEach(function(c){c.parseScale(),e.keys(c.component.scale).forEach(function(d){var f=c.component.scale[d];if(f){var g=b[d];if(g&&g.main){var h=g.main.domain,i=f.main.domain;if(e.isArray(h))e.isArray(f.main.domain)?g.main.domain=h.concat(i):a.addWarning("custom domain scale cannot be unioned with default field-based domain");else{var j=k.isUnionedDomain(h)?h.fields:[h];e.isArray(i)&&a.addWarning("custom domain scale cannot be unioned with default field-based domain");var l=k.isDataRefDomain(i)?j.concat([i]):k.isUnionedDomain(i)?j.concat(i.fields):j;l=e.unique(l,e.hash),l.length>1?g.main.domain={fields:l}:g.main.domain=l[0]}g.colorLegend=g.colorLegend?g.colorLegend:f.colorLegend,g.binColorLegend=g.binColorLegend?g.binColorLegend:f.binColorLegend}else b[d]=f;e.vals(f).forEach(function(b){var d=b.name.substr(c.name("").length),e=a.scaleName(d);c.renameScale(b.name,e),b.name=e}),delete f[d]}})})},b.prototype.parseMark=function(){this._children.forEach(function(a){a.parseMark()})},b.prototype.parseAxis=function(){var a=this.component.axis={};this._children.forEach(function(b){b.parseAxis(),e.keys(b.component.axis).forEach(function(c){a[c]||(a[c]=b.component.axis[c])})})},b.prototype.parseAxisGroup=function(){return null},b.prototype.parseGridGroup=function(){return null},b.prototype.parseLegend=function(){var a=this.component.legend={};this._children.forEach(function(b){b.parseLegend(),e.keys(b.component.legend).forEach(function(c){a[c]||(a[c]=b.component.legend[c])})})},b.prototype.assembleParentGroupProperties=function(){return null},b.prototype.assembleData=function(a){return g.assembleData(this,a),this._children.forEach(function(b){b.assembleData(a)}),a},b.prototype.assembleLayout=function(a){return this._children.forEach(function(b){b.assembleLayout(a)}),h.assembleLayout(this,a)},b.prototype.assembleMarks=function(){return e.flatten(this._children.map(function(a){return a.assembleMarks()}))},b.prototype.channels=function(){return[]},b.prototype.mapping=function(){return null},b.prototype.isLayer=function(){return!0},b.prototype.compatibleSource=function(a){var b=this.data(),c=a.component.data,d=!c.source||b&&b.url===c.source.url;return d},b}(i.Model);c.LayerModel=l},{"../config":43,"../util":60,"../vega.schema":62,"./common":12,"./data/data":17,"./layout":30,"./model":40}],30:[function(a,b,c){"use strict";function i(a,b){var c=a.component.layout;if(!c.width&&!c.height)return b;var d=g.keys(g.extend(c.width.distinct,c.height.distinct)),f=c.width.formula.concat(c.height.formula).map(function(a){return g.extend({type:"formula"},a)});return[d.length>0?{name:a.dataName(e.LAYOUT),source:a.dataTable(),transform:[{type:"aggregate",summarize:d.map(function(a){return{field:a,ops:["distinct"]}})}].concat(f)}:{name:a.dataName(e.LAYOUT),values:[{}],transform:f}]}function j(a){return{width:k(a,d.X),height:k(a,d.Y)}}function k(a,b){return{distinct:r(a,b),formula:[{field:a.channelSizeName(b),expr:l(a,b)}]}}function l(a,b){var c=a.scale(b);return c&&c.type===f.ScaleType.ORDINAL&&c.bandSize!==f.BANDSIZE_FIT?"("+s(a,b)+" + 1) * "+c.bandSize:(b===d.X?a.width:a.height)+""}function m(a){return{width:n(a,d.COLUMN),height:n(a,d.ROW)}}function n(a,b){var c=a.child().component.layout,e=b===d.ROW?"height":"width",f=c[e],h=g.extend(r(a,b),f.distinct),i=f.formula.concat([{field:a.channelSizeName(b),expr:o(a,b,a.child().channelSizeName(b))}]);return delete c[e],{distinct:h,formula:i}}function o(a,b,c){var d=a.scale(b);return a.has(b)?'(datum["'+c+'"] + '+d.padding+") * "+s(a,b):'datum["'+c+'"] + '+a.config().facet.scale.padding}function p(a){return{width:q(a,d.X),height:q(a,d.Y)}}function q(a,b){var c=a.children()[0].component.layout,e=b===d.Y?"height":"width",f=c[e],g=f.distinct,h=[{field:a.channelSizeName(b),expr:f.formula[0].expr}];return a.children().forEach(function(a){delete a.component.layout[e]}),{distinct:g,formula:h}}function r(a,b){if(a.has(b)&&a.isOrdinalScale(b)){var c=a.scale(b);if(c.type===f.ScaleType.ORDINAL&&!(c.domain instanceof Array)){var d=a.field(b),e={};return e[d]=!0,e}}return{}}function s(a,b){var c=a.scale(b);if(c.domain instanceof Array)return c.domain.length;var d=a.fieldDef(b).timeUnit,e=d?h.rawDomain(d,b):null;return null!==e?e.length:a.field(b,{datum:!0,prefix:"distinct"})}var d=a("../channel"),e=a("../data"),f=a("../scale"),g=a("../util"),h=a("../timeunit");c.assembleLayout=i,c.parseUnitLayout=j,c.unitSizeExpr=l,c.parseFacetLayout=m,c.parseLayerLayout=p,c.cardinalityExpr=s},{"../channel":10,"../data":44,"../scale":52,"../timeunit":57,"../util":60}],31:[function(a,b,c){"use strict";function k(a){return[d.COLOR,d.SIZE,d.SHAPE,d.OPACITY].reduce(function(b,c){return a.legend(c)&&(b[c]=m(a,c)),b},{})}function l(a,b){switch(b){case d.COLOR:var c=a.encoding().color,e=a.scaleName(o(c)?j.COLOR_LEGEND:d.COLOR);return a.config().mark.filled?{fill:e}:{stroke:e};case d.SIZE:return{size:a.scaleName(d.SIZE)};case d.SHAPE:return{shape:a.scaleName(d.SHAPE)};case d.OPACITY:return{opacity:a.scaleName(d.OPACITY)}}return null}function m(a,b){var c=a.fieldDef(b),d=a.legend(b),e=a.config(),f=l(a,b);f.title=n(d,c,e);var g=i.numberFormat(c,d.format,e);g&&(f.format=g),["offset","orient","values"].forEach(function(a){var b=d[a];void 0!==b&&(f[a]=b)});var j="boolean"!=typeof d&&d.properties||{};return["title","symbols","legend","labels"].forEach(function(d){var e=p[d]?p[d](c,j[d],a,b):j[d];void 0!==e&&h.keys(e).length>0&&(f.properties=f.properties||{},f.properties[d]=e)}),f}function n(a,b,c){return"boolean"!=typeof a&&a.title?a.title:e.title(b,c)}function o(a){return a.type===g.ORDINAL||a.bin||a.timeUnit}var d=a("../channel"),e=a("../fielddef"),f=a("../mark"),g=a("../type"),h=a("../util"),i=a("./common"),j=a("./scale");c.parseLegendComponent=k,c.parseLegend=m,c.title=n,c.useColorLegendScale=o;var p;!function(a){function b(a,b,c,e){var g={},j=c.mark(),k=c.legend(e);switch(j){case f.BAR:case f.TICK:case f.TEXT:g.shape={value:"square"};break;case f.CIRCLE:case f.SQUARE:g.shape={value:j};break;case f.POINT:case f.LINE:case f.AREA:}var l=c.config(),m=l.mark.filled,n=e===d.COLOR?h.without(i.FILL_STROKE_CONFIG,[m?"fill":"stroke","strokeDash","strokeDashOffset"]):h.without(i.FILL_STROKE_CONFIG,["strokeDash","strokeDashOffset"]);n=h.without(n,["strokeDash","strokeDashOffset"]),i.applyMarkConfig(g,c,n),m&&(g.strokeWidth={value:0}),e===d.OPACITY&&delete g.opacity;var p;return c.has(d.COLOR)&&e===d.COLOR?o(a)&&(p={scale:c.scaleName(d.COLOR),field:"data"}):c.encoding().color&&c.encoding().color.value&&(p={value:c.encoding().color.value}),void 0!==p?m?g.fill=p:g.stroke=p:e!==d.COLOR&&(g[m?"fill":"stroke"]=g[m?"fill":"stroke"]||{value:l.mark.color}),void 0!==k.symbolColor?g.fill={value:k.symbolColor}:void 0===g.fill&&(void 0!==l.mark.fill?g.fill={value:l.mark.fill}:void 0!==l.mark.stroke&&(g.stroke={value:l.mark.stroke})),e!==d.SHAPE&&(void 0!==k.symbolShape?g.shape={value:k.symbolShape}:void 0!==l.mark.shape&&(g.shape={value:l.mark.shape})),e!==d.SIZE&&void 0!==k.symbolSize&&(g.size={value:k.symbolSize}),void 0!==k.symbolStrokeWidth&&(g.strokeWidth={value:k.symbolStrokeWidth}),g=h.extend(g,b||{}),h.keys(g).length>0?g:void 0}function c(a,b,c,e){var f=c.legend(e),k=c.config(),l={};return e===d.COLOR&&(a.type===g.ORDINAL?b=h.extend({text:{scale:c.scaleName(j.COLOR_LEGEND),field:"data"}},b||{}):a.bin?b=h.extend({text:{scale:c.scaleName(j.COLOR_LEGEND_LABEL),field:"data"}},b||{}):a.type===g.TEMPORAL&&(b=h.extend({text:{template:i.timeTemplate('datum["data"]',a.timeUnit,f.format,f.shortTimeLabels,k)}},b||{}))),void 0!==f.labelAlign&&(l.align={value:f.labelAlign}),void 0!==f.labelColor&&(l.stroke={value:f.labelColor}),void 0!==f.labelFont&&(l.font={value:f.labelFont}),void 0!==f.labelFontSize&&(l.fontSize={value:f.labelFontSize}),void 0!==f.labelBaseline&&(l.baseline={value:f.labelBaseline}),l=h.extend(l,b||{}),h.keys(l).length>0?l:void 0}function e(a,b,c,d){var e=c.legend(d),f={};return void 0!==e.titleColor&&(f.stroke={value:e.titleColor}),void 0!==e.titleFont&&(f.font={value:e.titleFont}),void 0!==e.titleFontSize&&(f.fontSize={value:e.titleFontSize}),void 0!==e.titleFontWeight&&(f.fontWeight={value:e.titleFontWeight}),f=h.extend(f,b||{}),h.keys(f).length>0?f:void 0}a.symbols=b,a.labels=c,a.title=e}(p=c.properties||(c.properties={}))},{"../channel":10,"../fielddef":48,"../mark":51,"../type":59,"../util":60,"./common":12,"./scale":41}],32:[function(a,b,c){"use strict";var i,d=a("../../channel"),e=a("../../config"),f=a("../../fielddef"),g=a("../../scale"),h=a("../common");!function(a){function b(){return"area"}function c(a){var b={},c=a.config(),e=c.mark.orient;b.orient={value:e};var f=a.stack();b.x=i(a.encoding().x,a.scaleName(d.X),a.scale(d.X),e,f),b.y=k(a.encoding().y,a.scaleName(d.Y),a.scale(d.Y),e,f);var g=j(a.encoding().x,a.encoding().x2,a.scaleName(d.X),a.scale(d.X),e,f);g&&(b.x2=g);var m=l(a.encoding().y,a.encoding().y2,a.scaleName(d.Y),a.scale(d.Y),e,f);return m&&(b.y2=m),h.applyColorAndOpacity(b,a),h.applyMarkConfig(b,a,["interpolate","tension"]),b}function i(a,b,c,e,g){if(g&&d.X===g.fieldChannel)return{scale:b,field:f.field(a,{suffix:"start"})};if(a){if(a.field)return{scale:b,field:f.field(a,{binSuffix:"mid"})};if(a.value)return{scale:b,value:a.value}}return{value:0}}function j(a,b,c,h,i,j){if(i===e.Orient.HORIZONTAL){if(j&&d.X===j.fieldChannel)return{scale:c,field:f.field(a,{suffix:"end"})};if(b){if(b.field)return{scale:c,field:f.field(b)};if(b.value)return{scale:c,value:b.value}}return h.type===g.ScaleType.LOG||h.zero===!1?{value:0}:{scale:c,value:0}}return void 0}function k(a,b,c,e,g){if(g&&d.Y===g.fieldChannel)return{scale:b,field:f.field(a,{suffix:"start"})};if(a){if(a.field)return{scale:b,field:f.field(a,{binSuffix:"mid"})};if(a.value)return{scale:b,value:a.value}}return{value:0}}function l(a,b,c,h,i,j){if(i!==e.Orient.HORIZONTAL){if(j&&d.Y===j.fieldChannel)return{scale:c,field:f.field(a,{suffix:"end"})};if(b){if(b.field)return{scale:c,field:f.field(b)};if(b.value)return{scale:c,value:b.value}}return h.type===g.ScaleType.LOG||h.zero===!1?{field:{group:"height"}}:{scale:c,value:0}}return void 0}a.markType=b,a.properties=c,a.x=i,a.x2=j,a.y=k,a.y2=l}(i=c.area||(c.area={}))},{"../../channel":10,"../../config":43,"../../fielddef":48,"../../scale":52,"../common":12}],33:[function(a,b,c){"use strict";var i,d=a("../../channel"),e=a("../../config"),f=a("../../fielddef"),g=a("../../scale"),h=a("../common");!function(a){function b(){return"rect"}function c(a){var b={},c=a.config().mark.orient,j=a.stack(),k=a.encoding().x,l=a.encoding().x2,m=f.isMeasure(k)||f.isMeasure(l);j&&d.X===j.fieldChannel?(b.x={scale:a.scaleName(d.X),field:a.field(d.X,{suffix:"start"})},b.x2={scale:a.scaleName(d.X),field:a.field(d.X,{suffix:"end"})}):m?c===e.Orient.HORIZONTAL?(a.has(d.X)?b.x={scale:a.scaleName(d.X),field:a.field(d.X)}:b.x={scale:a.scaleName(d.X),value:0},a.has(d.X2)?b.x2={scale:a.scaleName(d.X),field:a.field(d.X2)}:a.scale(d.X).type===g.ScaleType.LOG||a.scale(d.X).zero===!1?b.x2={value:0}:b.x2={scale:a.scaleName(d.X),value:0}):(b.xc={scale:a.scaleName(d.X),field:a.field(d.X)},b.width={value:i(a,d.X)}):(a.has(d.X)?a.encoding().x.bin?a.has(d.SIZE)&&c!==e.Orient.HORIZONTAL?(b.xc={scale:a.scaleName(d.X),field:a.field(d.X,{binSuffix:"mid"})},b.width={scale:a.scaleName(d.SIZE),field:a.field(d.SIZE)}):(b.x={scale:a.scaleName(d.X),field:a.field(d.X,{binSuffix:"start"}),offset:1},b.x2={scale:a.scaleName(d.X),field:a.field(d.X,{binSuffix:"end"})}):a.scale(d.X).bandSize===g.BANDSIZE_FIT?b.x={scale:a.scaleName(d.X),field:a.field(d.X),offset:.5}:b.xc={scale:a.scaleName(d.X),field:a.field(d.X)}:b.x={value:0,offset:2},b.width=a.has(d.X)&&a.scale(d.X).bandSize===g.BANDSIZE_FIT?{scale:a.scaleName(d.X),band:!0,offset:-.5}:a.has(d.SIZE)&&c!==e.Orient.HORIZONTAL?{scale:a.scaleName(d.SIZE),field:a.field(d.SIZE)}:{value:i(a,d.X)});var n=a.encoding().y,o=a.encoding().y2,p=f.isMeasure(n)||f.isMeasure(o);return j&&d.Y===j.fieldChannel?(b.y={scale:a.scaleName(d.Y),field:a.field(d.Y,{suffix:"start"})},b.y2={scale:a.scaleName(d.Y),field:a.field(d.Y,{suffix:"end"})}):p?c!==e.Orient.HORIZONTAL?(a.has(d.Y)?b.y={scale:a.scaleName(d.Y),field:a.field(d.Y)}:b.y={scale:a.scaleName(d.Y),value:0},a.has(d.Y2)?b.y2={scale:a.scaleName(d.Y),field:a.field(d.Y2)}:a.scale(d.Y).type===g.ScaleType.LOG||a.scale(d.Y).zero===!1?b.y2={field:{group:"height"}}:b.y2={scale:a.scaleName(d.Y),value:0}):(b.yc={scale:a.scaleName(d.Y),field:a.field(d.Y)},b.height={value:i(a,d.Y)}):(a.has(d.Y)?a.encoding().y.bin?a.has(d.SIZE)&&c===e.Orient.HORIZONTAL?(b.yc={scale:a.scaleName(d.Y),field:a.field(d.Y,{binSuffix:"mid"})},b.height={scale:a.scaleName(d.SIZE),field:a.field(d.SIZE)}):(b.y={scale:a.scaleName(d.Y),field:a.field(d.Y,{binSuffix:"start"})},b.y2={scale:a.scaleName(d.Y),field:a.field(d.Y,{binSuffix:"end"}),offset:1}):a.scale(d.Y).bandSize===g.BANDSIZE_FIT?b.y={scale:a.scaleName(d.Y),field:a.field(d.Y),offset:.5}:b.yc={scale:a.scaleName(d.Y),field:a.field(d.Y)}:b.y2={field:{group:"height"},offset:-1},b.height=a.has(d.Y)&&a.scale(d.Y).bandSize===g.BANDSIZE_FIT?{scale:a.scaleName(d.Y),band:!0,offset:-.5}:a.has(d.SIZE)&&c===e.Orient.HORIZONTAL?{scale:a.scaleName(d.SIZE),field:a.field(d.SIZE)}:{value:i(a,d.Y)}),h.applyColorAndOpacity(b,a),b}function i(a,b){var c=a.encoding().size;if(c&&void 0!==c.value)return c.value;var d=a.config().mark;return d.barSize?d.barSize:a.isOrdinalScale(b)?a.scale(b).bandSize-1:a.has(b)?d.barThinSize:a.config().scale.bandSize-1}a.markType=b,a.properties=c}(i=c.bar||(c.bar={}))},{"../../channel":10,"../../config":43,"../../fielddef":48,"../../scale":52,"../common":12}],34:[function(a,b,c){"use strict";var g,d=a("../../channel"),e=a("../../fielddef"),f=a("../common");!function(a){function b(){return"line"}function c(a){var b={},c=a.config();b.x=g(a.encoding().x,a.scaleName(d.X),c),b.y=h(a.encoding().y,a.scaleName(d.Y),c);var e=i(a.encoding().size,c);return e&&(b.strokeWidth=e),f.applyColorAndOpacity(b,a),f.applyMarkConfig(b,a,["interpolate","tension"]),b}function g(a,b,c){return a&&a.field?{scale:b,field:e.field(a,{binSuffix:"mid"})}:{value:0}}function h(a,b,c){return a&&a.field?{scale:b,field:e.field(a,{binSuffix:"mid"})}:{field:{group:"height"}}}function i(a,b){return a&&void 0!==a.value?{value:a.value}:{value:b.mark.lineSize}}a.markType=b,a.properties=c}(g=c.line||(c.line={}))},{"../../channel":10,"../../fielddef":48,"../common":12}],35:[function(a,b,c){"use strict";function u(a){return k.contains([h.LINE,h.AREA],a.mark())?v(a):w(a)}function v(a){var b=a.mark(),c=a.parent()&&a.parent().isFacet(),e={data:a.dataTable()},f=z(a),g=[{name:a.name("marks"),type:t[b].markType(),from:k.extend(c||f.length>0?{}:e,{transform:[{type:"sort",by:y(a)}]}),properties:{update:t[b].properties(a)}}];if(f.length>0){var i={type:"facet",groupby:f},j=b===h.AREA&&a.stack()?A(a,!0).concat(i):[].concat(i,a.has(d.ORDER)?[{type:"sort",by:x(a)}]:[]);return[{name:a.name("pathgroup"),type:"group",from:k.extend(c?{}:e,{transform:j}),properties:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:g}]}return g}function w(a){var b=a.mark(),c=a.parent()&&a.parent().isFacet(),e={data:a.dataTable()},f=[];return b===h.TEXT&&a.has(d.COLOR)&&a.config().mark.applyColorToBackground&&!a.has(d.X)&&!a.has(d.Y)&&f.push(k.extend({name:a.name("background"),type:"rect"},c?{}:{from:e},{properties:{update:r.text.background(a)}})),f.push(k.extend({name:a.name("marks"),type:t[b].markType()},!c||a.stack()||a.has(d.ORDER)?{from:k.extend(c?{}:e,a.stack()?{transform:A(a,!1)}:a.has(d.ORDER)?{transform:[{type:"sort",by:x(a)}]}:{})}:{},{properties:{update:t[b].properties(a)}})),f}function x(a){if(a.has(d.ORDER)){var b=a.encoding().order;return b instanceof Array?b.map(n.sortField):n.sortField(b)}return null}function y(a){if(a.mark()===h.LINE&&a.has(d.PATH)){var b=a.encoding().path;return b instanceof Array?b.map(n.sortField):n.sortField(b)}var c=a.config().mark.orient===e.Orient.HORIZONTAL?d.Y:d.X,i=a.sort(c);return j.isSortField(i)?"-"+g.field({aggregate:f.isAggregate(a.encoding())?i.op:void 0,field:i.field}):"-"+a.field(c,{binSuffix:"mid"})}function z(a){return[d.COLOR,d.DETAIL,d.OPACITY,d.SHAPE].reduce(function(b,c){return a.has(c)&&!a.fieldDef(c).aggregate&&b.push(a.field(c)),b},[])}function A(a,b){var c=B(a);return b?[C(a,c),D(a,c)]:[D(a,c)]}function B(a){var b=a.encoding();return d.STACK_GROUP_CHANNELS.reduce(function(c,d){var e=b[d];if(f.has(b,d))if(k.isArray(e))e.forEach(function(a){c.push(g.field(a))});else{var h=e,j=a.scale(d),l=g.field(h,{binSuffix:j&&j.type===i.ScaleType.ORDINAL?"range":"start"});l&&c.push(l)}return c},[])}function C(a,b){var c=a.stack();return{type:"impute",field:a.field(c.fieldChannel),groupby:b,orderby:[a.field(c.groupbyChannel,{binSuffix:"mid"})],method:"value",value:0}}function D(a,b){var c=a.stack(),e=a.encoding(),f=a.has(d.ORDER)?(k.isArray(e[d.ORDER])?e[d.ORDER]:[e[d.ORDER]]).map(n.sortField):b.map(function(a){
return"-"+a}),g=a.field(c.fieldChannel),h={type:"stack",groupby:[a.field(c.groupbyChannel,{binSuffix:"mid"})||"undefined"],field:a.field(c.fieldChannel),sortby:f,output:{start:g+"_start",end:g+"_end"}};return c.offset&&(h.offset=c.offset),h}var d=a("../../channel"),e=a("../../config"),f=a("../../encoding"),g=a("../../fielddef"),h=a("../../mark"),i=a("../../scale"),j=a("../../sort"),k=a("../../util"),l=a("./area"),m=a("./bar"),n=a("../common"),o=a("./line"),p=a("./point"),q=a("./rule"),r=a("./text"),s=a("./tick"),t={area:l.area,bar:m.bar,line:o.line,point:p.point,text:r.text,tick:s.tick,rule:q.rule,circle:p.circle,square:p.square};c.parseMark=u},{"../../channel":10,"../../config":43,"../../encoding":46,"../../fielddef":48,"../../mark":51,"../../scale":52,"../../sort":54,"../../util":60,"../common":12,"./area":32,"./bar":33,"./line":34,"./point":36,"./rule":37,"./text":38,"./tick":39}],36:[function(a,b,c){"use strict";var g,d=a("../../channel"),e=a("../../fielddef"),f=a("../common");!function(a){function b(){return"symbol"}function c(a,b){var c={},e=a.config();return c.x=g(a.encoding().x,a.scaleName(d.X),e),c.y=h(a.encoding().y,a.scaleName(d.Y),e),c.size=i(a.encoding().size,a.scaleName(d.SIZE),a.scale(d.SIZE),e),c.shape=j(a.encoding().shape,a.scaleName(d.SHAPE),a.scale(d.SHAPE),e,b),f.applyColorAndOpacity(c,a),c}function g(a,b,c){return a&&a.field?{scale:b,field:e.field(a,{binSuffix:"mid"})}:{value:c.scale.bandSize/2}}function h(a,b,c){return a&&a.field?{scale:b,field:e.field(a,{binSuffix:"mid"})}:{value:c.scale.bandSize/2}}function i(a,b,c,d){if(a){if(a.field)return{scale:b,field:e.field(a,{scaleType:c.type})};if(void 0!==a.value)return{value:a.value}}return{value:d.mark.size}}function j(a,b,c,d,f){if(f)return{value:f};if(a){if(a.field)return{scale:b,field:e.field(a,{scaleType:c.type})};if(a.value)return{value:a.value}}return{value:d.mark.shape}}a.markType=b,a.properties=c}(g=c.point||(c.point={}));var h;!function(a){function b(){return"symbol"}function c(a){return g.properties(a,"circle")}a.markType=b,a.properties=c}(h=c.circle||(c.circle={}));var i;!function(a){function b(){return"symbol"}function c(a){return g.properties(a,"square")}a.markType=b,a.properties=c}(i=c.square||(c.square={}))},{"../../channel":10,"../../fielddef":48,"../common":12}],37:[function(a,b,c){"use strict";var g,d=a("../../channel"),e=a("../../config"),f=a("../common");!function(a){function b(){return"rule"}function c(a){var b={};return a.config().mark.orient===e.Orient.VERTICAL?(a.has(d.X)?b.x={scale:a.scaleName(d.X),field:a.field(d.X,{binSuffix:"mid"})}:b.x={value:0},a.has(d.Y)?b.y={scale:a.scaleName(d.Y),field:a.field(d.Y,{binSuffix:"mid"})}:b.y={field:{group:"height"}},a.has(d.Y2)?b.y2={scale:a.scaleName(d.Y),field:a.field(d.Y2,{binSuffix:"mid"})}:b.y2={value:0}):(a.has(d.Y)?b.y={scale:a.scaleName(d.Y),field:a.field(d.Y,{binSuffix:"mid"})}:b.y={value:0},a.has(d.X)?b.x={scale:a.scaleName(d.X),field:a.field(d.X,{binSuffix:"mid"})}:b.x={value:0},a.has(d.X2)?b.x2={scale:a.scaleName(d.X),field:a.field(d.X2,{binSuffix:"mid"})}:b.x2={field:{group:"width"}}),f.applyColorAndOpacity(b,a),a.has(d.SIZE)?b.strokeWidth={scale:a.scaleName(d.SIZE),field:a.field(d.SIZE)}:b.strokeWidth={value:g(a)},b}function g(a){var b=a.encoding().size;return b&&void 0!==b.value?b.value:a.config().mark.ruleSize}a.markType=b,a.properties=c}(g=c.rule||(c.rule={}))},{"../../channel":10,"../../config":43,"../common":12}],38:[function(a,b,c){"use strict";var h,d=a("../../channel"),e=a("../common"),f=a("../../fielddef"),g=a("../../type");!function(a){function b(){return"text"}function c(a){return{x:{value:0},y:{value:0},width:{field:{group:"width"}},height:{field:{group:"height"}},fill:{scale:a.scaleName(d.COLOR),field:a.field(d.COLOR,a.encoding().color.type===g.ORDINAL?{prefix:"rank"}:{})}}}function h(a){var b={};e.applyMarkConfig(b,a,["angle","align","baseline","dx","dy","font","fontWeight","fontStyle","radius","theta","text"]);var c=a.config(),f=a.encoding().text;if(b.x=i(a.encoding().x,a.scaleName(d.X),c,f),b.y=j(a.encoding().y,a.scaleName(d.Y),c),b.fontSize=k(a.encoding().size,a.scaleName(d.SIZE),c),b.text=l(f,a.scaleName(d.TEXT),c),!a.config().mark.applyColorToBackground||a.has(d.X)||a.has(d.Y))e.applyColorAndOpacity(b,a);else{b.fill={value:"black"};var g=a.config().mark.opacity;g&&(b.opacity={value:g})}return b}function i(a,b,c,d){return a&&a.field?{scale:b,field:f.field(a,{binSuffix:"mid"})}:d&&d.type===g.QUANTITATIVE?{field:{group:"width"},offset:-5}:{value:c.scale.textBandWidth/2}}function j(a,b,c){return a&&a.field?{scale:b,field:f.field(a,{binSuffix:"mid"})}:{value:c.scale.bandSize/2}}function k(a,b,c){if(a){if(a.field)return{scale:b,field:f.field(a)};if(a.value)return{value:a.value}}return{value:c.mark.fontSize}}function l(a,b,c){if(a){if(a.field){if(g.QUANTITATIVE===a.type){var d=e.numberFormat(a,c.mark.format,c),h="number"+(d?":'"+d+"'":"");return{template:"{{"+f.field(a,{datum:!0})+" | "+h+"}}"}}return g.TEMPORAL===a.type?{template:e.timeTemplate(f.field(a,{datum:!0}),a.timeUnit,c.mark.format,c.mark.shortTimeLabels,c)}:{field:a.field}}if(a.value)return{value:a.value}}return{value:c.mark.text}}a.markType=b,a.background=c,a.properties=h}(h=c.text||(c.text={}))},{"../../channel":10,"../../fielddef":48,"../../type":59,"../common":12}],39:[function(a,b,c){"use strict";var h,d=a("../../channel"),e=a("../../config"),f=a("../../fielddef"),g=a("../common");!function(a){function b(){return"rect"}function c(a){var b={},c=a.config();return b.xc=h(a.encoding().x,a.scaleName(d.X),c),b.yc=i(a.encoding().y,a.scaleName(d.Y),c),c.mark.orient===e.Orient.HORIZONTAL?(b.width=j(a.encoding().size,a.scaleName(d.SIZE),c,(a.scale(d.X)||{}).bandSize),b.height={value:c.mark.tickThickness}):(b.width={value:c.mark.tickThickness},b.height=j(a.encoding().size,a.scaleName(d.SIZE),c,(a.scale(d.Y)||{}).bandSize)),g.applyColorAndOpacity(b,a),b}function h(a,b,c){if(a){if(a.field)return{scale:b,field:f.field(a,{binSuffix:"mid"})};if(a.value)return{value:a.value}}return{value:c.scale.bandSize/2}}function i(a,b,c){if(a){if(a.field)return{scale:b,field:f.field(a,{binSuffix:"mid"})};if(a.value)return{value:a.value}}return{value:c.scale.bandSize/2}}function j(a,b,c,d){if(a){if(a.field)return{scale:b,field:a.field};if(void 0!==a.value)return{value:a.value}}if(c.mark.tickSize)return{value:c.mark.tickSize};var e=void 0!==d?d:c.scale.bandSize;return{value:e/1.5}}a.markType=b,a.properties=c}(h=c.tick||(c.tick={}))},{"../../channel":10,"../../config":43,"../../fielddef":48,"../common":12}],40:[function(a,b,c){"use strict";var d=a("../channel"),e=a("../encoding"),f=a("../fielddef"),g=a("../scale"),h=a("../util"),i=function(){function a(){this._nameMap={}}return a.prototype.rename=function(a,b){this._nameMap[a]=b},a.prototype.get=function(a){for(;this._nameMap[a];)a=this._nameMap[a];return a},a}(),j=function(){function a(a,b,c){this._warnings=[],this._parent=b,this._name=a.name||c,this._dataNameMap=b?b._dataNameMap:new i,this._scaleNameMap=b?b._scaleNameMap:new i,this._sizeNameMap=b?b._sizeNameMap:new i,this._data=a.data,this._description=a.description,this._transform=a.transform,this.component={data:null,layout:null,mark:null,scale:null,axis:null,axisGroup:null,gridGroup:null,legend:null}}return a.prototype.parse=function(){this.parseData(),this.parseSelectionData(),this.parseLayoutData(),this.parseScale(),this.parseAxis(),this.parseLegend(),this.parseAxisGroup(),this.parseGridGroup(),this.parseMark()},a.prototype.assembleScales=function(){return h.flatten(h.vals(this.component.scale).map(function(a){var b=[a.main];return a.colorLegend&&b.push(a.colorLegend),a.binColorLegend&&b.push(a.binColorLegend),b}))},a.prototype.assembleAxes=function(){return h.vals(this.component.axis)},a.prototype.assembleLegends=function(){return h.vals(this.component.legend)},a.prototype.assembleGroup=function(){var a={};a.marks=this.assembleMarks();var b=this.assembleScales();b.length>0&&(a.scales=b);var c=this.assembleAxes();c.length>0&&(a.axes=c);var d=this.assembleLegends();return d.length>0&&(a.legends=d),a},a.prototype.reduce=function(a,b,c){return e.channelMappingReduce(this.channels(),this.mapping(),a,b,c)},a.prototype.forEach=function(a,b){e.channelMappingForEach(this.channels(),this.mapping(),a,b)},a.prototype.parent=function(){return this._parent},a.prototype.name=function(a,b){return void 0===b&&(b="_"),(this._name?this._name+b:"")+a},a.prototype.description=function(){return this._description},a.prototype.data=function(){return this._data},a.prototype.renameData=function(a,b){this._dataNameMap.rename(a,b)},a.prototype.dataName=function(a){return this._dataNameMap.get(this.name(String(a)))},a.prototype.renameSize=function(a,b){this._sizeNameMap.rename(a,b)},a.prototype.channelSizeName=function(a){return this.sizeName(a===d.X||a===d.COLUMN?"width":"height")},a.prototype.sizeName=function(a){return this._sizeNameMap.get(this.name(a,"_"))},a.prototype.transform=function(){return this._transform||{}},a.prototype.field=function(a,b){void 0===b&&(b={});var c=this.fieldDef(a);return c.bin&&(b=h.extend({binSuffix:this.scale(a).type===g.ScaleType.ORDINAL?"range":"start"},b)),f.field(c,b)},a.prototype.scale=function(a){return this._scale[a]},a.prototype.isOrdinalScale=function(a){var b=this.scale(a);return b&&b.type===g.ScaleType.ORDINAL},a.prototype.renameScale=function(a,b){this._scaleNameMap.rename(a,b)},a.prototype.scaleName=function(a){return this._scaleNameMap.get(this.name(a+""))},a.prototype.sort=function(a){return(this.mapping()[a]||{}).sort},a.prototype.axis=function(a){return this._axis[a]},a.prototype.legend=function(a){return this._legend[a]},a.prototype.config=function(){return this._config},a.prototype.addWarning=function(a){h.warning(a),this._warnings.push(a)},a.prototype.warnings=function(){return this._warnings},a.prototype.isUnit=function(){return!1},a.prototype.isFacet=function(){return!1},a.prototype.isLayer=function(){return!1},a}();c.Model=j},{"../channel":10,"../encoding":46,"../fielddef":48,"../scale":52,"../util":60}],41:[function(a,b,c){"use strict";function p(a){return a.channels().reduce(function(b,c){if(a.scale(c)){var d=a.fieldDef(c),f={main:q(a,d,c)};c===e.COLOR&&a.legend(e.COLOR)&&(d.type===m.ORDINAL||d.bin||d.timeUnit)&&(f.colorLegend=r(a,d),d.bin&&(f.binColorLegend=s(a,d))),b[c]=f}return b},{})}function q(a,b,d){var f=a.scale(d),g=a.sort(d),h={name:a.scaleName(d),type:f.type};return d===e.X&&a.has(e.X2)?a.has(e.X)?h.domain={fields:[v(f,a,e.X),v(f,a,e.X2)]}:h.domain=v(f,a,e.X2):d===e.Y&&a.has(e.Y2)?a.has(e.Y)?h.domain={fields:[v(f,a,e.Y),v(f,a,e.Y2)]}:h.domain=v(f,a,e.Y2):h.domain=v(f,a,d),n.extend(h,y(f,a,d)),g&&(k.isSortField(g)?g.order:g)===k.SortOrder.DESCENDING&&(h.reverse=!0),["round","clamp","nice","exponent","zero","points","padding"].forEach(function(e){var g=c[e](f,d,b,a,h);void 0!==g&&(h[e]=g)}),h}function r(a,b){return{name:a.scaleName(c.COLOR_LEGEND),type:j.ScaleType.ORDINAL,domain:{data:a.dataTable(),field:a.field(e.COLOR,b.bin||b.timeUnit?{}:{prefix:"rank"}),sort:!0},range:{data:a.dataTable(),field:a.field(e.COLOR),sort:!0}}}function s(a,b){return{name:a.scaleName(c.COLOR_LEGEND_LABEL),type:j.ScaleType.ORDINAL,domain:{data:a.dataTable(),field:a.field(e.COLOR),sort:!0},range:{data:a.dataTable(),field:h.field(b,{binSuffix:"range"}),sort:{field:a.field(e.COLOR,{binSuffix:"start"}),op:"min"}}}}function t(a,b,c,d){if(!e.hasScale(c))return null;if(n.contains([e.ROW,e.COLUMN,e.SHAPE],c))return a&&void 0!==a.type&&a.type!==j.ScaleType.ORDINAL&&console.warn("Channel",c,"does not work with scale type =",a.type),j.ScaleType.ORDINAL;if(void 0!==a.type)return a.type;switch(b.type){case m.NOMINAL:return j.ScaleType.ORDINAL;case m.ORDINAL:return c===e.COLOR?j.ScaleType.LINEAR:j.ScaleType.ORDINAL;case m.TEMPORAL:return c===e.COLOR?j.ScaleType.TIME:b.timeUnit?o.defaultScaleType(b.timeUnit):j.ScaleType.TIME;case m.QUANTITATIVE:return b.bin?n.contains([e.X,e.Y,e.COLOR],c)?j.ScaleType.LINEAR:j.ScaleType.ORDINAL:j.ScaleType.LINEAR}return null}function u(a,b,c,d,f,g){return a===j.ScaleType.ORDINAL?void 0===d?b?b:g===e.X&&f===i.TEXT?c.textBandWidth:c.bandSize:(b&&console.warn("bandSize for",g,"overridden as top-level",g===e.X?"width":"height","is provided."),j.BANDSIZE_FIT):void 0}function v(a,b,c){var d=b.fieldDef(c);if(a.domain)return a.domain;if(d.type===m.TEMPORAL)return o.rawDomain(d.timeUnit,c)?{data:d.timeUnit,field:"date"}:{data:b.dataTable(),field:b.field(c),sort:{field:b.field(c),op:"min"}};var f=b.stack();if(f&&c===f.fieldChannel)return f.offset===l.StackOffset.NORMALIZE?[0,1]:{data:b.dataName(g.STACKED_SCALE),field:b.field(c,{prefix:"sum"})};var h=x(a,b,c),i=w(b,c,a.type);return h?{data:g.SOURCE,field:b.field(c,{noAggregate:!0})}:d.bin?a.type===j.ScaleType.ORDINAL?{data:b.dataTable(),field:b.field(c,{binSuffix:"range"}),sort:{field:b.field(c,{binSuffix:"start"}),op:"min"}}:c===e.COLOR?{data:b.dataTable(),field:b.field(c,{binSuffix:"start"})}:{data:b.dataTable(),field:[b.field(c,{binSuffix:"start"}),b.field(c,{binSuffix:"end"})]}:i?{data:i.op?g.SOURCE:b.dataTable(),field:d.type===m.ORDINAL&&c===e.COLOR?b.field(c,{prefix:"rank"}):b.field(c),sort:i}:{data:b.dataTable(),field:d.type===m.ORDINAL&&c===e.COLOR?b.field(c,{prefix:"rank"}):b.field(c)}}function w(a,b,c){if(c!==j.ScaleType.ORDINAL)return void 0;var d=a.sort(b);return k.isSortField(d)?{op:d.op,field:d.field}:n.contains([k.SortOrder.ASCENDING,k.SortOrder.DESCENDING,void 0],d)?!0:void 0}function x(a,b,c){var e=b.fieldDef(c);return a.useRawDomain&&e.aggregate&&d.SHARED_DOMAIN_OPS.indexOf(e.aggregate)>=0&&(e.type===m.QUANTITATIVE&&!e.bin||e.type===m.TEMPORAL&&n.contains([j.ScaleType.TIME,j.ScaleType.UTC],a.type))}function y(a,b,c){var d=b.fieldDef(c),g=b.config().scale;if(a.type===j.ScaleType.ORDINAL&&a.bandSize&&a.bandSize!==j.BANDSIZE_FIT&&n.contains([e.X,e.Y],c))return{bandSize:a.bandSize};if(a.range&&!n.contains([e.X,e.Y,e.ROW,e.COLUMN],c))return{range:a.range};switch(c){case e.ROW:return{range:"height"};case e.COLUMN:return{range:"width"}}var h=b;switch(c){case e.X:return{rangeMin:0,rangeMax:h.width};case e.Y:return{rangeMin:h.height,rangeMax:0};case e.SIZE:if(h.mark()===i.BAR){if(void 0!==g.barSizeRange)return{range:g.barSizeRange};var k=b.config().mark.orient===f.Orient.HORIZONTAL?e.Y:e.X;return{range:[b.config().mark.barThinSize,b.scale(k).bandSize]}}if(h.mark()===i.TEXT)return{range:g.fontSizeRange};if(h.mark()===i.RULE)return{range:g.ruleSizeRange};if(h.mark()===i.TICK)return{range:g.tickSizeRange};if(void 0!==g.pointSizeRange)return{range:g.pointSizeRange};var l=z(h);return{range:[9,(l-2)*(l-2)]};case e.SHAPE:return{range:g.shapeRange};case e.COLOR:return d.type===m.NOMINAL?{range:g.nominalColorRange}:{range:g.sequentialColorRange};case e.OPACITY:return{range:g.opacity}}return{}}function z(a){var b=a.config().scale,c=a.has(e.X),d=a.has(e.Y),f=h.isMeasure(a.encoding().x),g=h.isMeasure(a.encoding().y);return c&&d?f!==g?a.scale(f?e.Y:e.X).bandSize:Math.min(a.scale(e.X).bandSize||b.bandSize,a.scale(e.Y).bandSize||b.bandSize):d?g?a.config().scale.bandSize:a.scale(e.Y).bandSize:c?f?a.config().scale.bandSize:a.scale(e.X).bandSize:a.config().scale.bandSize}function A(a){return n.contains([j.ScaleType.LINEAR,j.ScaleType.POW,j.ScaleType.SQRT,j.ScaleType.LOG,j.ScaleType.TIME,j.ScaleType.UTC],a.type)?a.clamp:void 0}function B(a){return a.type===j.ScaleType.POW?a.exponent:void 0}function C(a,b,c){return n.contains([j.ScaleType.LINEAR,j.ScaleType.POW,j.ScaleType.SQRT,j.ScaleType.LOG,j.ScaleType.TIME,j.ScaleType.UTC,j.ScaleType.QUANTIZE],a.type)?void 0!==a.nice?a.nice:n.contains([j.ScaleType.TIME,j.ScaleType.UTC],a.type)?o.smallestUnit(c.timeUnit):n.contains([e.X,e.Y],b):void 0}function D(a,b,c,d,f){return a.type===j.ScaleType.ORDINAL&&n.contains([e.X,e.Y],b)?f.points?1:a.padding:void 0}function E(a,b,c,d){return a.type===j.ScaleType.ORDINAL&&n.contains([e.X,e.Y],b)?d.mark()===i.BAR&&a.bandSize===j.BANDSIZE_FIT?void 0:!0:void 0}function F(a,b){return n.contains([e.X,e.Y,e.ROW,e.COLUMN,e.SIZE],b)&&void 0!==a.round?a.round:void 0}function G(a,b,c){return n.contains([j.ScaleType.TIME,j.ScaleType.UTC,j.ScaleType.ORDINAL],a.type)?void 0:void 0!==a.zero?a.zero:!a.domain&&!c.bin&&n.contains([e.X,e.Y],b)}var d=a("../aggregate"),e=a("../channel"),f=a("../config"),g=a("../data"),h=a("../fielddef"),i=a("../mark"),j=a("../scale"),k=a("../sort"),l=a("../stack"),m=a("../type"),n=a("../util"),o=a("../timeunit");c.COLOR_LEGEND="color_legend",c.COLOR_LEGEND_LABEL="color_legend_label",c.parseScaleComponent=p,c.scaleType=t,c.scaleBandSize=u,c.domain=v,c.domainSort=w,c.rangeMixins=y,c.clamp=A,c.exponent=B,c.nice=C,c.padding=D,c.points=E,c.round=F,c.zero=G},{"../aggregate":7,"../channel":10,"../config":43,"../data":44,"../fielddef":48,"../mark":51,"../scale":52,"../sort":54,"../stack":56,"../timeunit":57,"../type":59,"../util":60}],42:[function(a,b,c){"use strict";var d=this&&this.__extends||function(a,b){function d(){this.constructor=a}for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);a.prototype=null===b?Object.create(b):(d.prototype=b.prototype,new d)},e=a("../aggregate"),f=a("../channel"),g=a("../config"),h=a("../data"),i=a("../encoding"),j=a("../fielddef"),k=a("../mark"),l=a("../scale"),m=a("../type"),n=a("../util"),o=a("./axis"),p=a("./common"),q=a("./config"),r=a("./data/data"),s=a("./legend"),t=a("./layout"),u=a("./model"),v=a("./mark/mark"),w=a("./scale"),x=a("../stack"),y=function(a){function b(b,c,d){a.call(this,b,c,d);var e=void 0!==b.width?b.width:c?c.width:void 0,f=void 0!==b.height?b.height:c?c.height:void 0,g=this._mark=b.mark,h=this._encoding=this._initEncoding(g,b.encoding||{}),i=this._config=this._initConfig(b.config,c,g,h);this._scale=this._initScale(g,h,i,e,f),this._axis=this._initAxis(h,i),this._legend=this._initLegend(h,i),this._initSize(g,this._scale,e,f,i.cell,i.scale),this._stack=x.stack(g,h,i)}return d(b,a),b.prototype._initEncoding=function(a,b){return b=n.duplicate(b),i.forEach(b,function(b,c){return f.supportMark(c,a)?(b.type&&(b.type=m.getFullName(b.type)),void(c!==f.PATH&&c!==f.ORDER||b.aggregate||b.type!==m.QUANTITATIVE||(b.aggregate=e.AggregateOp.MIN))):(console.warn(c,"dropped as it is incompatible with",a),void delete b.field)}),b},b.prototype._initConfig=function(a,b,c,d){var e=n.mergeDeep(n.duplicate(g.defaultConfig),b?b.config():{},a);return e.mark=q.initMarkConfig(c,d,e),e},b.prototype._initScale=function(a,b,c,d,e){return f.UNIT_SCALE_CHANNELS.reduce(function(g,h){if(i.has(b,h)||h===f.X&&i.has(b,f.X2)||h===f.Y&&i.has(b,f.Y2)){var j=b[h],k=(j||{}).scale||{},l=w.scaleType(k,j,h,a),m=g[h]=n.extend({type:l,round:c.scale.round,padding:c.scale.padding,useRawDomain:c.scale.useRawDomain},k);m.bandSize=w.scaleBandSize(m.type,m.bandSize,c.scale,h===f.X?d:e,a,h)}return g},{})},b.prototype._initSize=function(a,b,c,d,e,g){void 0!==c?this._width=c:b[f.X]?(b[f.X].type!==l.ScaleType.ORDINAL||b[f.X].bandSize===l.BANDSIZE_FIT)&&(this._width=e.width):a===k.TEXT?this._width=g.textBandWidth:this._width=g.bandSize,void 0!==d?this._height=d:b[f.Y]?(b[f.Y].type!==l.ScaleType.ORDINAL||b[f.Y].bandSize===l.BANDSIZE_FIT)&&(this._height=e.height):this._height=g.bandSize},b.prototype._initAxis=function(a,b){return[f.X,f.Y].reduce(function(c,d){if(i.has(a,d)||d===f.X&&i.has(a,f.X2)||d===f.Y&&i.has(a,f.Y2)){var e=(a[d]||{}).axis;e!==!1&&(c[d]=n.extend({},b.axis,e===!0?{}:e||{}))}return c},{})},b.prototype._initLegend=function(a,b){return f.NONSPATIAL_SCALE_CHANNELS.reduce(function(c,d){if(i.has(a,d)){var e=a[d].legend;e!==!1&&(c[d]=n.extend({},b.legend,e===!0?{}:e||{}))}return c},{})},Object.defineProperty(b.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),b.prototype.parseData=function(){this.component.data=r.parseUnitData(this)},b.prototype.parseSelectionData=function(){},b.prototype.parseLayoutData=function(){this.component.layout=t.parseUnitLayout(this)},b.prototype.parseScale=function(){this.component.scale=w.parseScaleComponent(this)},b.prototype.parseMark=function(){this.component.mark=v.parseMark(this)},b.prototype.parseAxis=function(){this.component.axis=o.parseAxisComponent(this,[f.X,f.Y])},b.prototype.parseAxisGroup=function(){return null},b.prototype.parseGridGroup=function(){return null},b.prototype.parseLegend=function(){this.component.legend=s.parseLegendComponent(this)},b.prototype.assembleData=function(a){return r.assembleData(this,a)},b.prototype.assembleLayout=function(a){return t.assembleLayout(this,a)},b.prototype.assembleMarks=function(){return this.component.mark},b.prototype.assembleParentGroupProperties=function(a){return p.applyConfig({},a,p.FILL_STROKE_CONFIG.concat(["clip"]))},b.prototype.channels=function(){return f.UNIT_CHANNELS},b.prototype.mapping=function(){return this.encoding()},b.prototype.stack=function(){return this._stack},b.prototype.toSpec=function(a,b){var d,c=n.duplicate(this._encoding);return d={mark:this._mark,encoding:c},a||(d.config=n.duplicate(this._config)),b||(d.data=n.duplicate(this._data)),d},b.prototype.mark=function(){return this._mark},b.prototype.has=function(a){return i.has(this._encoding,a)},b.prototype.encoding=function(){return this._encoding},b.prototype.fieldDef=function(a){return this._encoding[a]||{}},b.prototype.field=function(a,b){void 0===b&&(b={});var c=this.fieldDef(a);return c.bin&&(b=n.extend({binSuffix:this.scale(a).type===l.ScaleType.ORDINAL?"range":"start"},b)),j.field(c,b)},b.prototype.dataTable=function(){return this.dataName(i.isAggregate(this._encoding)?h.SUMMARY:h.SOURCE)},b.prototype.isUnit=function(){return!0},b}(u.Model);c.UnitModel=y},{"../aggregate":7,"../channel":10,"../config":43,"../data":44,"../encoding":46,"../fielddef":48,"../mark":51,"../scale":52,"../stack":56,"../type":59,"../util":60,"./axis":11,"./common":12,"./config":14,"./data/data":17,"./layout":30,"./legend":31,"./mark/mark":35,"./model":40,"./scale":41}],43:[function(a,b,c){"use strict";var d=a("./scale"),e=a("./axis"),f=a("./legend");c.defaultCellConfig={width:200,height:200},c.defaultFacetCellConfig={stroke:"#ccc",strokeWidth:1};var g={color:"#000000",opacity:.4,offset:0};c.defaultFacetConfig={scale:d.defaultFacetScaleConfig,axis:e.defaultFacetAxisConfig,grid:g,cell:c.defaultFacetCellConfig},function(a){a[a.NORMAL="normal"]="NORMAL",a[a.BOLD="bold"]="BOLD"}(c.FontWeight||(c.FontWeight={}));c.FontWeight;!function(a){a[a.CIRCLE="circle"]="CIRCLE",a[a.SQUARE="square"]="SQUARE",a[a.CROSS="cross"]="CROSS",a[a.DIAMOND="diamond"]="DIAMOND",a[a.TRIANGLEUP="triangle-up"]="TRIANGLEUP",a[a.TRIANGLEDOWN="triangle-down"]="TRIANGLEDOWN"}(c.Shape||(c.Shape={}));var i=c.Shape;!function(a){a[a.HORIZONTAL="horizontal"]="HORIZONTAL",a[a.VERTICAL="vertical"]="VERTICAL"}(c.Orient||(c.Orient={}));c.Orient;!function(a){a[a.LEFT="left"]="LEFT",a[a.RIGHT="right"]="RIGHT",a[a.CENTER="center"]="CENTER"}(c.HorizontalAlign||(c.HorizontalAlign={}));c.HorizontalAlign;!function(a){a[a.TOP="top"]="TOP",a[a.MIDDLE="middle"]="MIDDLE",a[a.BOTTOM="bottom"]="BOTTOM"}(c.VerticalAlign||(c.VerticalAlign={}));var l=c.VerticalAlign;!function(a){a[a.NORMAL="normal"]="NORMAL",a[a.ITALIC="italic"]="ITALIC"}(c.FontStyle||(c.FontStyle={}));c.FontStyle;!function(a){a[a.LINEAR="linear"]="LINEAR",a[a.LINEAR_CLOSED="linear-closed"]="LINEAR_CLOSED",a[a.STEP="step"]="STEP",a[a.STEP_BEFORE="step-before"]="STEP_BEFORE",a[a.STEP_AFTER="step-after"]="STEP_AFTER",a[a.BASIS="basis"]="BASIS",a[a.BASIS_OPEN="basis-open"]="BASIS_OPEN",a[a.BASIS_CLOSED="basis-closed"]="BASIS_CLOSED",a[a.CARDINAL="cardinal"]="CARDINAL",a[a.CARDINAL_OPEN="cardinal-open"]="CARDINAL_OPEN",a[a.CARDINAL_CLOSED="cardinal-closed"]="CARDINAL_CLOSED",a[a.BUNDLE="bundle"]="BUNDLE",a[a.MONOTONE="monotone"]="MONOTONE"}(c.Interpolate||(c.Interpolate={}));c.Interpolate;!function(a){a[a.LINE="line"]="LINE",a[a.LINEPOINT="linepoint"]="LINEPOINT",a[a.NONE="none"]="NONE"}(c.AreaOverlay||(c.AreaOverlay={}));c.AreaOverlay;c.defaultOverlayConfig={line:!1,pointStyle:{filled:!0},lineStyle:{}},c.defaultMarkConfig={color:"#4682b4",shape:i.CIRCLE,strokeWidth:2,size:30,barThinSize:2,ruleSize:1,tickThickness:1,fontSize:10,baseline:l.MIDDLE,text:"Abc",shortTimeLabels:!1,applyColorToBackground:!1},c.defaultConfig={numberFormat:"s",timeFormat:"%Y-%m-%d",countTitle:"Number of Records",cell:c.defaultCellConfig,mark:c.defaultMarkConfig,overlay:c.defaultOverlayConfig,scale:d.defaultScaleConfig,axis:e.defaultAxisConfig,legend:f.defaultLegendConfig,facet:c.defaultFacetConfig}},{"./axis":8,"./legend":50,"./scale":52}],44:[function(a,b,c){"use strict";var d=a("./type");!function(a){a[a.JSON="json"]="JSON",a[a.CSV="csv"]="CSV",a[a.TSV="tsv"]="TSV",a[a.TOPOJSON="topojson"]="TOPOJSON"}(c.DataFormatType||(c.DataFormatType={}));c.DataFormatType;!function(a){a[a.SOURCE="source"]="SOURCE",a[a.SUMMARY="summary"]="SUMMARY",a[a.STACKED_SCALE="stacked_scale"]="STACKED_SCALE",a[a.LAYOUT="layout"]="LAYOUT"}(c.DataTable||(c.DataTable={}));var f=c.DataTable;c.SUMMARY=f.SUMMARY,c.SOURCE=f.SOURCE,c.STACKED_SCALE=f.STACKED_SCALE,c.LAYOUT=f.LAYOUT,c.types={"boolean":d.Type.NOMINAL,number:d.Type.QUANTITATIVE,integer:d.Type.QUANTITATIVE,date:d.Type.TEMPORAL,string:d.Type.NOMINAL}},{"./type":59}],45:[function(a,b,c){"use strict";function e(a){return!!(a.year||a.quarter||a.month||a.date||a.day||a.hours||a.minutes||a.seconds||a.milliseconds)}function f(a){return d.isNumber(a)?a-1+"":(console.warn("Potentially invalid quarter",a),a)}function g(a){if(d.isNumber(a))return a-1+"";var b=a.toLowerCase(),e=c.MONTHS.indexOf(b);if(-1!==e)return e+"";var f=b.substr(0,3),g=c.SHORT_MONTHS.indexOf(f);return-1!==g?g+"":(console.warn("Potentially invalid month",a),a)}function h(a){if(d.isNumber(a))return a%7+"";var b=a.toLowerCase(),e=c.DAYS.indexOf(b);if(-1!==e)return e+"";var f=b.substr(0,3),g=c.SHORT_DAYS.indexOf(f);return-1!==g?g+"":(console.warn("Potentially invalid day",a),a)}function i(a,b){void 0===b&&(b=!1);var c=[];if(b&&void 0!==a.day)for(var e=0,i=["year","quarter","month","date"];e<i.length;e++){var j=i[e];if(void 0!==a[j]){console.warn("Dropping day from datetime",JSON.stringify(a),"as day cannot be combined with",j),a=d.duplicate(a),delete a.day;break}}if(void 0!==a.year?c.push(a.year):void 0!==a.day?c.push(2006):c.push(0),void 0!==a.month){var k=b?g(a.month):a.month;c.push(k)}else if(void 0!==a.quarter){var l=b?f(a.quarter):a.quarter;c.push(l+"*3")}else c.push(0);if(void 0!==a.date)c.push(a.date);else if(void 0!==a.day){var m=b?h(a.day):a.day;c.push(m+"+1")}else c.push(1);for(var n=0,o=["hours","minutes","seconds","milliseconds"];n<o.length;n++){var p=o[n];void 0!==a[p]?c.push(a[p]):c.push(0)}return"datetime("+c.join(", ")+")"}var d=a("./util");c.isDateTime=e,c.MONTHS=["january","february","march","april","may","june","july","august","september","october","november","december"],c.SHORT_MONTHS=c.MONTHS.map(function(a){return a.substr(0,3)}),c.DAYS=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],c.SHORT_DAYS=c.DAYS.map(function(a){return a.substr(0,3)}),c.dateTimeExpr=i},{"./util":60}],46:[function(a,b,c){"use strict";function f(a){var b=0;return a.color&&b++,a.opacity&&b++,a.size&&b++,a.shape&&b++,b}function g(a){return d.CHANNELS.filter(function(b){return h(a,b)})}function h(a,b){var c=a&&a[b];return c&&(void 0!==c.field||e.isArray(c)&&c.length>0)}function i(a){return e.some(d.CHANNELS,function(b){return h(a,b)&&a[b].aggregate?!0:!1})}function j(a){return a&&(!!a.x&&!!a.x2||!!a.y&&!!a.y2)}function k(a){var b=[];return d.CHANNELS.forEach(function(c){h(a,c)&&(e.isArray(a[c])?a[c].forEach(function(a){b.push(a)}):b.push(a[c]))}),b}function l(a,b,c){m(d.CHANNELS,a,b,c)}function m(a,b,c,d){var f=0;a.forEach(function(a){h(b,a)&&(e.isArray(b[a])?b[a].forEach(function(b){c.call(d,b,a,f++)}):c.call(d,b[a],a,f++))})}function n(a,b,c){return o(d.CHANNELS,a,b,c)}function o(a,b,c,d){var f=[];return a.forEach(function(a){h(b,a)&&(e.isArray(b[a])?b[a].forEach(function(b){f.push(c.call(d,b,a))}):f.push(c.call(d,b[a],a)))}),f}function p(a,b,c,e){return q(d.CHANNELS,a,b,c,e)}function q(a,b,c,f,g){var i=f;return d.CHANNELS.forEach(function(a){h(b,a)&&(e.isArray(b[a])?b[a].forEach(function(b){i=c.call(g,i,b,a)}):i=c.call(g,i,b[a],a))}),i}var d=a("./channel"),e=a("./util");c.countRetinal=f,c.channels=g,c.has=h,c.isAggregate=i,c.isRanged=j,c.fieldDefs=k,c.forEach=l,c.channelMappingForEach=m,c.map=n,c.channelMappingMap=o,c.reduce=p,c.channelMappingReduce=q},{"./channel":10,"./util":60}],47:[function(a,b,c){"use strict"},{}],48:[function(a,b,c){"use strict";function h(a,b){void 0===b&&(b={});var c=a.field,d=b.prefix,f=b.suffix;if(m(a))c="count";else{var g=b.fn;b.nofn||(a.bin?(g="bin",f=b.binSuffix||(b.scaleType===e.ScaleType.ORDINAL?"range":"start")):!b.noAggregate&&a.aggregate?g=String(a.aggregate):a.timeUnit&&(g=String(a.timeUnit))),g&&(c=g+"_"+c)}return f&&(c=c+"_"+f),d&&(c=d+"_"+c),b.datum&&(c='datum["'+c+'"]'),c}function i(a){return g.contains([f.NOMINAL,f.ORDINAL],a.type)?!0:a.bin?!0:a.type===f.TEMPORAL?!!a.timeUnit:!1}function j(a){return a&&a.field&&i(a)}function k(a){return a&&a.field&&!i(a)}function l(){return{field:"*",aggregate:d.AggregateOp.COUNT,type:f.QUANTITATIVE}}function m(a){return a.aggregate===d.AggregateOp.COUNT}function n(a,b){if(null!=a.title)return a.title;if(m(a))return b.countTitle;var c=a.aggregate||a.timeUnit||a.bin&&"bin";return c?c.toString().toUpperCase()+"("+a.field+")":a.field}var d=a("./aggregate"),e=a("./scale"),f=a("./type"),g=a("./util");c.field=h,c.isDimension=j,c.isMeasure=k,c.count=l,c.isCount=m,c.title=n},{"./aggregate":7,"./scale":52,"./type":59,"./util":60}],49:[function(a,b,c){"use strict";function h(a){return a&&!!a.field&&void 0!==a.equal}function i(a){return a&&a.field&&g.isArray(a.range)&&2===a.range.length?!0:!1}function j(a){return a&&!!a.field&&(g.isArray(a.oneOf)||g.isArray(a["in"]))}function k(a){if(g.isString(a))return a;var b=a.timeUnit?"time("+f.fieldExpr(a.timeUnit,a.field)+")":e.field(a,{datum:!0});if(h(a))return b+"==="+l(a.equal,a.timeUnit);if(j(a)){var c=a.oneOf||a["in"];return"indexof(["+c.map(function(b){return l(b,a.timeUnit)}).join(",")+"], "+b+") !== -1"}if(i(a)){var d=a.range[0],k=a.range[1];if(null!==d&&null!==k)return"inrange("+b+", "+l(d,a.timeUnit)+", "+l(k,a.timeUnit)+")";if(null!==d)return b+" >= "+d;if(null!==k)return b+" <= "+k}return void 0}function l(a,b){if(d.isDateTime(a)){var c=d.dateTimeExpr(a,!0);return"time("+c+")"}if(f.isSingleTimeUnit(b)){var e={};e[b]=a;var c=d.dateTimeExpr(e,!0);return"time("+c+")"}return JSON.stringify(a)}var d=a("./datetime"),e=a("./fielddef"),f=a("./timeunit"),g=a("./util");c.isEqualFilter=h,c.isRangeFilter=i,c.isOneOfFilter=j,c.expression=k},{"./datetime":45,"./fielddef":48,"./timeunit":57,"./util":60}],50:[function(a,b,c){"use strict";c.defaultLegendConfig={orient:void 0,shortTimeLabels:!1}},{}],51:[function(a,b,c){"use strict";!function(a){a[a.AREA="area"]="AREA",a[a.BAR="bar"]="BAR",a[a.LINE="line"]="LINE",a[a.POINT="point"]="POINT",a[a.TEXT="text"]="TEXT",a[a.TICK="tick"]="TICK",a[a.RULE="rule"]="RULE",a[a.CIRCLE="circle"]="CIRCLE",a[a.SQUARE="square"]="SQUARE",a[a.ERRORBAR="errorBar"]="ERRORBAR"}(c.Mark||(c.Mark={}));var d=c.Mark;c.AREA=d.AREA,c.BAR=d.BAR,c.LINE=d.LINE,c.POINT=d.POINT,c.TEXT=d.TEXT,c.TICK=d.TICK,c.RULE=d.RULE,c.CIRCLE=d.CIRCLE,c.SQUARE=d.SQUARE,c.ERRORBAR=d.ERRORBAR,c.PRIMITIVE_MARKS=[c.AREA,c.BAR,c.LINE,c.POINT,c.TEXT,c.TICK,c.RULE,c.CIRCLE,c.SQUARE]},{}],52:[function(a,b,c){"use strict";!function(a){a[a.LINEAR="linear"]="LINEAR",a[a.LOG="log"]="LOG",a[a.POW="pow"]="POW",a[a.SQRT="sqrt"]="SQRT",a[a.QUANTILE="quantile"]="QUANTILE",a[a.QUANTIZE="quantize"]="QUANTIZE",a[a.ORDINAL="ordinal"]="ORDINAL",a[a.TIME="time"]="TIME",a[a.UTC="utc"]="UTC"}(c.ScaleType||(c.ScaleType={}));c.ScaleType;!function(a){a[a.SECOND="second"]="SECOND",a[a.MINUTE="minute"]="MINUTE",a[a.HOUR="hour"]="HOUR",a[a.DAY="day"]="DAY",a[a.WEEK="week"]="WEEK",a[a.MONTH="month"]="MONTH",a[a.YEAR="year"]="YEAR"}(c.NiceTime||(c.NiceTime={}));c.NiceTime;!function(a){a[a.FIT="fit"]="FIT";
}(c.BandSize||(c.BandSize={}));var f=c.BandSize;c.BANDSIZE_FIT=f.FIT,c.defaultScaleConfig={round:!0,textBandWidth:90,bandSize:21,padding:.1,useRawDomain:!1,opacity:[.3,.8],nominalColorRange:"category10",sequentialColorRange:["#AFC6A3","#09622A"],shapeRange:"shapes",fontSizeRange:[8,40],ruleSizeRange:[1,5],tickSizeRange:[1,20]},c.defaultFacetScaleConfig={round:!0,padding:16}},{}],53:[function(a,b,c){"use strict";function i(a){return"mark"+c.ASSIGN+a.mark+c.DELIM+k(a.encoding)}function j(a,b,d){var e=a.split(c.DELIM),f=e.shift().split(c.ASSIGN)[1].trim(),g=l(e.join(c.DELIM)),i={mark:h.Mark[f],encoding:g};return void 0!==b&&(i.data=b),void 0!==d&&(i.config=d),i}function k(a){return g.map(a,function(a,b){return b+c.ASSIGN+m(a)}).join(c.DELIM)}function l(a){return a.split(c.DELIM).reduce(function(a,b){var d=b.split(c.ASSIGN),e=d[0].trim(),f=d[1];return a[e]=o(f),a},{})}function m(a){return(a.aggregate?a.aggregate+c.FUNC:"")+(a.timeUnit?a.timeUnit+c.FUNC:"")+(a.bin?"bin"+c.FUNC:"")+(a.field||"")+c.TYPE+f.SHORT_TYPE[a.type]}function n(a,b){return void 0===b&&(b=c.DELIM),a.map(m).join(b)}function o(a){for(var b=a.split(c.TYPE),g={field:b[0].trim(),type:f.TYPE_FROM_SHORT_TYPE[b[1].trim()]},h=0;h<d.AGGREGATE_OPS.length;h++){var i=d.AGGREGATE_OPS[h];if(0===g.field.indexOf(i+"_")){g.field=g.field.substr(i.toString().length+1),i===d.AggregateOp.COUNT&&0===g.field.length&&(g.field="*"),g.aggregate=i;break}}for(var h=0;h<e.TIMEUNITS.length;h++){var j=e.TIMEUNITS[h];if(g.field&&0===g.field.indexOf(j+"_")){g.field=g.field.substr(g.field.length+1),g.timeUnit=j;break}}return g.field&&0===g.field.indexOf("bin_")&&(g.field=g.field.substr(4),g.bin=!0),g}var d=a("./aggregate"),e=a("./timeunit"),f=a("./type"),g=a("./encoding"),h=a("./mark");c.DELIM="|",c.ASSIGN="=",c.TYPE=",",c.FUNC="_",c.shorten=i,c.parse=j,c.shortenEncoding=k,c.parseEncoding=l,c.shortenFieldDef=m,c.shortenFieldDefs=n,c.parseFieldDef=o},{"./aggregate":7,"./encoding":46,"./mark":51,"./timeunit":57,"./type":59}],54:[function(a,b,c){"use strict";function e(a){return!!a&&!!a.field&&!!a.op}!function(a){a[a.ASCENDING="ascending"]="ASCENDING",a[a.DESCENDING="descending"]="DESCENDING",a[a.NONE="none"]="NONE"}(c.SortOrder||(c.SortOrder={}));c.SortOrder;c.isSortField=e},{}],55:[function(a,b,c){"use strict";function k(a){return void 0!==a.facet}function l(a){if(n(a)){var b=e.has(a.encoding,h.ROW),c=e.has(a.encoding,h.COLUMN);return b||c}return!1}function m(a){return n(a)?!l(a):!1}function n(a){return void 0!==a.mark}function o(a){return void 0!==a.layers}function p(a){return l(a)?q(a):m(a)?r(a):a}function q(a){var b=e.has(a.encoding,h.ROW),c=e.has(a.encoding,h.COLUMN),d=j.duplicate(a.encoding);return delete d.column,delete d.row,j.extend(a.name?{name:a.name}:{},a.description?{description:a.description}:{},{data:a.data},a.transform?{transform:a.transform}:{},{facet:j.extend(b?{row:a.encoding.row}:{},c?{column:a.encoding.column}:{}),spec:r({mark:a.mark,encoding:d})},a.config?{config:a.config}:{})}function r(a){var b=a.config,c=b&&b.overlay,g=c&&a.mark===f.AREA&&j.contains([d.AreaOverlay.LINEPOINT,d.AreaOverlay.LINE],c.area),h=c&&(c.line&&a.mark===f.LINE||c.area===d.AreaOverlay.LINEPOINT&&a.mark===f.AREA);return a.mark===f.ERRORBAR?t(a):e.isRanged(a.encoding)?s(a):w(a)?a:h||g?u(a,h,g):a}function s(a){if(a.encoding){var b=e.has(a.encoding,h.X),c=e.has(a.encoding,h.Y),d=e.has(a.encoding,h.X2),f=e.has(a.encoding,h.Y2);if(d&&!b||f&&!c){var g=j.duplicate(a);return d&&!b&&(g.encoding.x=g.encoding.x2,delete g.encoding.x2),f&&!c&&(g.encoding.y=g.encoding.y2,delete g.encoding.y2),g}}return a}function t(a){var b=j.extend(a.name?{name:a.name}:{},a.description?{description:a.description}:{},a.data?{data:a.data}:{},a.transform?{transform:a.transform}:{},a.config?{config:a.config}:{},{layers:[]});if(!a.encoding)return b;if(a.mark===f.ERRORBAR){var c={mark:f.RULE,encoding:j.extend(a.encoding.x?{x:j.duplicate(a.encoding.x)}:{},a.encoding.y?{y:j.duplicate(a.encoding.y)}:{},a.encoding.x2?{x2:j.duplicate(a.encoding.x2)}:{},a.encoding.y2?{y2:j.duplicate(a.encoding.y2)}:{},{})},d={mark:f.TICK,encoding:j.extend(a.encoding.x?{x:j.duplicate(a.encoding.x)}:{},a.encoding.y?{y:j.duplicate(a.encoding.y)}:{},a.encoding.size?{size:j.duplicate(a.encoding.size)}:{},{})},e={mark:f.TICK,encoding:j.extend({x:a.encoding.x2?j.duplicate(a.encoding.x2):j.duplicate(a.encoding.x),y:a.encoding.y2?j.duplicate(a.encoding.y2):j.duplicate(a.encoding.y)},a.encoding.size?{size:j.duplicate(a.encoding.size)}:{})};b.layers.push(r(c)),b.layers.push(r(d)),b.layers.push(r(e))}return b}function u(a,b,c){var e=["name","description","data","transform"],g=j.omit(a,e.concat("config")),h=j.duplicate(a.config);delete h.overlay;var i=j.extend(j.pick(a,e),{layers:[g]},j.keys(h).length>0?{config:h}:{});if(c){var k=j.duplicate(g);k.mark=f.LINE;var l=j.extend({},d.defaultOverlayConfig.lineStyle,a.config.overlay.lineStyle);j.keys(l).length>0&&(k.config={mark:l}),i.layers.push(k)}if(b){var m=j.duplicate(g);m.mark=f.POINT;var l=j.extend({},d.defaultOverlayConfig.pointStyle,a.config.overlay.pointStyle);j.keys(l).length>0&&(m.config={mark:l}),i.layers.push(m)}return i}function v(a){return i.fieldDefs(a.encoding)}function w(a){return null!==g.stack(a.mark,a.encoding,a.config)}var d=a("./config"),e=a("./encoding"),f=a("./mark"),g=a("./stack"),h=a("./channel"),i=a("./encoding"),j=a("./util");c.isFacetSpec=k,c.isExtendedUnitSpec=l,c.isUnitSpec=m,c.isSomeUnitSpec=n,c.isLayerSpec=o,c.normalize=p,c.normalizeExtendedUnitSpec=q,c.normalizeUnitSpec=r,c.normalizeRangedUnitSpec=s,c.normalizeErrorBarUnitSpec=t,c.normalizeOverlay=u,c.fieldDefs=v,c.isStacked=w},{"./channel":10,"./config":43,"./encoding":46,"./mark":51,"./stack":56,"./util":60}],56:[function(a,b,c){"use strict";function i(a,b,c){var i=c&&c.mark?c.mark.stacked:void 0;if(g.contains([h.NONE,null,!1],i))return null;if(!g.contains([f.BAR,f.AREA],a))return null;if(!e.isAggregate(b))return null;var j=d.STACK_GROUP_CHANNELS.reduce(function(a,c){return e.has(b,c)&&!b[c].aggregate&&a.push(c),a},[]);if(0===j.length)return null;var k=e.has(b,d.X),l=e.has(b,d.Y),m=k&&!!b.x.aggregate,n=l&&!!b.y.aggregate;return m!==n?{groupbyChannel:m?l?d.Y:null:k?d.X:null,fieldChannel:m?d.X:d.Y,stackByChannels:j,offset:i||h.ZERO}:null}var d=a("./channel"),e=a("./encoding"),f=a("./mark"),g=a("./util");!function(a){a[a.ZERO="zero"]="ZERO",a[a.CENTER="center"]="CENTER",a[a.NORMALIZE="normalize"]="NORMALIZE",a[a.NONE="none"]="NONE"}(c.StackOffset||(c.StackOffset={}));var h=c.StackOffset;c.stack=i},{"./channel":10,"./encoding":46,"./mark":51,"./util":60}],57:[function(a,b,c){"use strict";function j(a){return!!i[a]}function k(a,b){var d=new Date(0,0,1,0,0,0,0);return c.SINGLE_TIMEUNITS.forEach(function(c){if(n(a,c))switch(c){case h.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case h.YEAR:d.setFullYear(b.getFullYear());break;case h.QUARTER:d.setMonth(3*Math.floor(b.getMonth()/3));break;case h.MONTH:d.setMonth(b.getMonth());break;case h.DATE:d.setDate(b.getDate());break;case h.HOURS:d.setHours(b.getHours());break;case h.MINUTES:d.setMinutes(b.getMinutes());break;case h.SECONDS:d.setSeconds(b.getSeconds());break;case h.MILLISECONDS:d.setMilliseconds(b.getMilliseconds())}}),d}function m(a){return!!l[a]}function n(a,b){var c=a.toString(),d=b.toString(),e=c.indexOf(d);return e>-1&&(b!==h.SECONDS||0===e||"i"!==c.charAt(e-1))}function o(a){switch(a){case h.HOURS:case h.DAY:case h.MONTH:case h.QUARTER:return f.ScaleType.ORDINAL}return f.ScaleType.TIME}function p(a,b){function f(a){return a===h.QUARTER?"floor(month("+d+")/3)":a+"("+d+")"}var d='datum["'+b+'"]',i=c.SINGLE_TIMEUNITS.reduce(function(b,c){return n(a,c)&&(b[c]=f(c)),b},{});return i.day&&g.keys(i).length>1&&(console.warn('Time unit "'+a+'" is not supported. We are replacing it with ',(a+"").replace("day","date")+"."),delete i.day,i.date=f(h.DATE)),e.dateTimeExpr(i)}function q(a,b){if(g.contains([d.ROW,d.COLUMN,d.SHAPE,d.COLOR],b))return null;switch(a){case h.SECONDS:return g.range(0,60);case h.MINUTES:return g.range(0,60);case h.HOURS:return g.range(0,24);case h.DAY:return g.range(0,7);case h.DATE:return g.range(1,32);case h.MONTH:return g.range(0,12);case h.QUARTER:return[0,3,6,9]}return null}function r(a){return a?n(a,h.SECONDS)?"second":n(a,h.MINUTES)?"minute":n(a,h.HOURS)?"hour":n(a,h.DAY)||n(a,h.DATE)?"day":n(a,h.MONTH)?"month":n(a,h.YEAR)?"year":void 0:void 0}function s(a,b,c){if(!a)return void 0;var d=[];n(a,h.YEAR)&&d.push(c?"%y":"%Y"),n(a,h.QUARTER)&&d.push("'}}Q{{"+b+" | quarter}}{{"+b+" | time:'"),n(a,h.MONTH)&&d.push(c?"%b":"%B"),n(a,h.DAY)?d.push(c?"%a":"%A"):n(a,h.DATE)&&d.push("%d");var e=[];n(a,h.HOURS)&&e.push("%H"),n(a,h.MINUTES)&&e.push("%M"),n(a,h.SECONDS)&&e.push("%S"),n(a,h.MILLISECONDS)&&e.push("%L");var f=[];if(d.length>0&&f.push(d.join("-")),e.length>0&&f.push(e.join(":")),f.length>0){var g="{{"+b+" | time:'"+f.join(" ")+"'}}",i=b.replace(/(\[|\])/g,"\\$1");return g.replace(new RegExp("{{"+i+" \\| time:''}}","g"),"")}return void 0}var d=a("./channel"),e=a("./datetime"),f=a("./scale"),g=a("./util");!function(a){a[a.YEAR="year"]="YEAR",a[a.MONTH="month"]="MONTH",a[a.DAY="day"]="DAY",a[a.DATE="date"]="DATE",a[a.HOURS="hours"]="HOURS",a[a.MINUTES="minutes"]="MINUTES",a[a.SECONDS="seconds"]="SECONDS",a[a.MILLISECONDS="milliseconds"]="MILLISECONDS",a[a.YEARMONTH="yearmonth"]="YEARMONTH",a[a.YEARMONTHDATE="yearmonthdate"]="YEARMONTHDATE",a[a.YEARMONTHDATEHOURS="yearmonthdatehours"]="YEARMONTHDATEHOURS",a[a.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes"]="YEARMONTHDATEHOURSMINUTES",a[a.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds"]="YEARMONTHDATEHOURSMINUTESSECONDS",a[a.HOURSMINUTES="hoursminutes"]="HOURSMINUTES",a[a.HOURSMINUTESSECONDS="hoursminutesseconds"]="HOURSMINUTESSECONDS",a[a.MINUTESSECONDS="minutesseconds"]="MINUTESSECONDS",a[a.SECONDSMILLISECONDS="secondsmilliseconds"]="SECONDSMILLISECONDS",a[a.QUARTER="quarter"]="QUARTER",a[a.YEARQUARTER="yearquarter"]="YEARQUARTER",a[a.QUARTERMONTH="quartermonth"]="QUARTERMONTH",a[a.YEARQUARTERMONTH="yearquartermonth"]="YEARQUARTERMONTH"}(c.TimeUnit||(c.TimeUnit={}));var h=c.TimeUnit;c.SINGLE_TIMEUNITS=[h.YEAR,h.QUARTER,h.MONTH,h.DAY,h.DATE,h.HOURS,h.MINUTES,h.SECONDS,h.MILLISECONDS];var i=c.SINGLE_TIMEUNITS.reduce(function(a,b){return a[b]=!0,a},{});c.isSingleTimeUnit=j,c.convert=k,c.MULTI_TIMEUNITS=[h.YEARQUARTER,h.YEARQUARTERMONTH,h.YEARMONTH,h.YEARMONTHDATE,h.YEARMONTHDATEHOURS,h.YEARMONTHDATEHOURSMINUTES,h.YEARMONTHDATEHOURSMINUTESSECONDS,h.QUARTERMONTH,h.HOURSMINUTES,h.HOURSMINUTESSECONDS,h.MINUTESSECONDS,h.SECONDSMILLISECONDS];var l=c.MULTI_TIMEUNITS.reduce(function(a,b){return a[b]=!0,a},{});c.isMultiTimeUnit=m,c.TIMEUNITS=c.SINGLE_TIMEUNITS.concat(c.MULTI_TIMEUNITS),c.containsTimeUnit=n,c.defaultScaleType=o,c.fieldExpr=p,c.rawDomain=q,c.smallestUnit=r,c.template=s},{"./channel":10,"./datetime":45,"./scale":52,"./util":60}],58:[function(a,b,c){"use strict"},{}],59:[function(a,b,c){"use strict";function e(a){var b=a;return c.TYPE_FROM_SHORT_TYPE[b.toUpperCase()]||b.toLowerCase()}!function(a){a[a.QUANTITATIVE="quantitative"]="QUANTITATIVE",a[a.ORDINAL="ordinal"]="ORDINAL",a[a.TEMPORAL="temporal"]="TEMPORAL",a[a.NOMINAL="nominal"]="NOMINAL"}(c.Type||(c.Type={}));var d=c.Type;c.QUANTITATIVE=d.QUANTITATIVE,c.ORDINAL=d.ORDINAL,c.TEMPORAL=d.TEMPORAL,c.NOMINAL=d.NOMINAL,c.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},c.TYPE_FROM_SHORT_TYPE={Q:c.QUANTITATIVE,T:c.TEMPORAL,O:c.ORDINAL,N:c.NOMINAL},c.getFullName=e},{}],60:[function(a,b,c){"use strict";function h(a,b){var c={};return b.forEach(function(b){a.hasOwnProperty(b)&&(c[b]=a[b])}),c}function i(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("Infinite range");var f,d=[],e=-1;if(0>c)for(;(f=a+c*++e)>b;)d.push(f);else for(;(f=a+c*++e)<b;)d.push(f);return d}function j(a,b){var c=f.duplicate(a);return b.forEach(function(a){delete c[a]}),c}function k(a){return g.isString(a)||g.isNumber(a)||g.isBoolean(a)?String(a):d(a)}function l(a,b){return a.indexOf(b)>-1}function m(a,b){return a.filter(function(a){return!l(b,a)})}function n(a,b){return a.concat(m(b,a))}function o(a,b,c){if(a.forEach)a.forEach.call(c,b);else for(var d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function p(a,b,c,d){if(a.reduce)return a.reduce.call(d,b,c);for(var e in a)a.hasOwnProperty(e)&&(c=b.call(d,c,a[e],e,a));return c}function q(a,b,c){if(a.map)return a.map.call(c,b);var d=[];for(var e in a)a.hasOwnProperty(e)&&d.push(b.call(c,a[e],e,a));return d}function r(a,b){for(var c=0,d=0;d<a.length;d++)if(b(a[d],d,c++))return!0;return!1}function s(a,b){for(var c=0,d=0;d<a.length;d++)if(!b(a[d],d,c++))return!1;return!0}function t(a){return[].concat.apply([],a)}function u(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];for(var d=0;d<b.length;d++)a=v(a,b[d]);return a}function v(a,b){if("object"!=typeof b||null===b)return a;for(var c in b)b.hasOwnProperty(c)&&void 0!==b[c]&&("object"!=typeof b[c]||null===b[c]?a[c]=b[c]:"object"!=typeof a[c]||null===a[c]?a[c]=u(b[c].constructor===Array?[]:{},b[c]):u(a[c],b[c]));return a}function w(a,b){var e,f,g,c=[],d={};for(f=0,g=a.length;g>f;++f)e=b?b(a[f]):a[f],e in d||(d[e]=1,c.push(a[f]));return c}function x(a){console.warn("[VL Warning]",a)}function y(a){console.error("[VL Error]",a)}function z(a,b){for(var c in a)if(a.hasOwnProperty(c)&&b[c]&&a[c]&&b[c]!==a[c])return!0;return!1}var d=a("json-stable-stringify"),e=a("datalib/src/util");c.keys=e.keys,c.extend=e.extend,c.duplicate=e.duplicate,c.isArray=e.isArray,c.vals=e.vals,c.truncate=e.truncate,c.toMap=e.toMap,c.isObject=e.isObject,c.isString=e.isString,c.isNumber=e.isNumber,c.isBoolean=e.isBoolean;var f=a("datalib/src/util"),g=a("datalib/src/util");c.pick=h,c.range=i,c.omit=j,c.hash=k,c.contains=l,c.without=m,c.union=n,c.forEach=o,c.reduce=p,c.map=q,c.some=r,c.every=s,c.flatten=t,c.mergeDeep=u,c.unique=w,c.warning=x,c.error=y,c.differ=z},{"datalib/src/util":2,"json-stable-stringify":3}],61:[function(a,b,c){"use strict";function f(a,b,d){void 0===b&&(b=c.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===d&&(d=c.DEFAULT_SUPPORTED_CHANNEL_TYPE);var f=a.mark,g=a.encoding,h=b[f],i=d[f];for(var j in h)if(!(h[j]in g))return'Missing encoding channel "'+h[j]+'" for mark "'+f+'"';for(var k in g)if(!i[k])return'Encoding channel "'+k+'" is not supported by mark type "'+f+'"';return f!==e.BAR||g.x||g.y?null:"Missing both x and y for bar"}var d=a("./util"),e=a("./mark");c.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},c.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:d.toMap(["row","column","x","y","size","color","detail"]),line:d.toMap(["row","column","x","y","color","detail"]),area:d.toMap(["row","column","x","y","color","detail"]),tick:d.toMap(["row","column","x","y","color","detail"]),circle:d.toMap(["row","column","x","y","color","size","detail"]),square:d.toMap(["row","column","x","y","color","size","detail"]),point:d.toMap(["row","column","x","y","color","size","detail","shape"]),text:d.toMap(["row","column","size","color","text"])},c.getEncodingMappingError=f},{"./mark":51,"./util":60}],62:[function(a,b,c){"use strict";function e(a){return d.isArray(a)?!1:"fields"in a}function f(a){return d.isArray(a)?!1:"data"in a}var d=a("./util");c.isUnionedDomain=e,c.isDataRefDomain=f},{"./util":60}],63:[function(a,b,c){"use strict";c.axis=a("./axis"),c.aggregate=a("./aggregate"),c.bin=a("./bin"),c.channel=a("./channel"),c.compile=a("./compile/compile").compile,c.config=a("./config"),c.data=a("./data"),c.datetime=a("./datetime"),c.encoding=a("./encoding"),c.facet=a("./facet"),c.fieldDef=a("./fielddef"),c.legend=a("./legend"),c.mark=a("./mark"),c.scale=a("./scale"),c.shorthand=a("./shorthand"),c.sort=a("./sort"),c.spec=a("./spec"),c.stack=a("./stack"),c.timeUnit=a("./timeunit"),c.transform=a("./transform"),c.type=a("./type"),c.util=a("./util"),c.validate=a("./validate"),c.version="1.2.0"},{"./aggregate":7,"./axis":8,"./bin":9,"./channel":10,"./compile/compile":13,"./config":43,"./data":44,"./datetime":45,"./encoding":46,"./facet":47,"./fielddef":48,"./legend":50,"./mark":51,"./scale":52,"./shorthand":53,"./sort":54,"./spec":55,"./stack":56,"./timeunit":57,"./transform":58,"./type":59,"./util":60,"./validate":61}]},{},[63])(63)});
